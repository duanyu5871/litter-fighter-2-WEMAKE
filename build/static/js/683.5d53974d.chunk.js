"use strict";(self.webpackChunklittle_fighter_j=self.webpackChunklittle_fighter_j||[]).push([[683],{6063:(e,n,t)=>{t.d(n,{C:()=>i,W:()=>a});let a=function(e){return e.AttackerType="attacker_type",e.VictimType="victim_type",e.VictimIsChasing="victim_is_chasing",e.ItrEffect="itr_effect",e.ItrKind="itr_kind",e.SameFacing="same_facing",e.AttackerState="attacker_state",e.VictimState="victim_state",e.AttackerHasHolder="attacker_has_holder",e.VictimHasHolder="victim_has_holder",e.AttackerHasHolding="attacker_has_holding",e.VictimHasHolding="victim_has_holding",e.SameTeam="same_team",e.AttackerOID="attacker_oid",e.VictimOID="victim_oid",e.BdyKind="bdy_kind",e.VictimFrameId="victim_frame_id",e.VictimFrameIndex_ICE="victim_frame_index_ice",e.ItrFall="itr_fall",e.AttackerThrew="attacker_threw",e.VictimThrew="victim_threw",e.VictimIsFreezableBall="victim_freezable_ball",e.AttackerIsFreezableBall="attacker_freezable_ball",e.ArmorWork="armor_work",e.V_FrameBehavior="v_frame_behavior",e.NoItrEffect="no_itr_effect",e.A_HP_P="a_hp_p",e.V_HP_P="v_hp_p",e.LF2_NET_ON="lf2_net_on",e.BdyHitFlag="bdy_hit_flag",e.ItrHitFlag="itr_hit_flag",e.BdyCode="bdy_code",e.ItrCode="itr_code",e}({});const i=a},8255:(e,n,t)=>{function a(e){return new Promise((n,t)=>{const a=document.createElement("input");a.type="file","boolean"===typeof(null===e||void 0===e?void 0:e.multiple)&&(a.multiple=e.multiple),"string"===typeof(null===e||void 0===e?void 0:e.accept)&&(a.accept=e.accept),a.click(),a.oncancel=()=>t("cancel"),a.onchange=()=>{a.files?a.files.length?n(Array.from(a.files)):t("[open_file] files is empty!"):t("[open_file] files got null!")}})}function i(){return new Promise((e,n)=>{const t=document.createElement("input");t.type="file",t.setAttribute("directory","true"),t.setAttribute("webkitdirectory","true"),t.click(),t.oncancel=()=>n("cancel"),t.onchange=()=>{t.files?t.files.length?e(Array.from(t.files)):n("[open_file] files is empty!"):n("[open_file] files got null!")}})}function s(e,n){return new Promise((t,a)=>{const i=new FileReader;switch(n.as){case"ArrayBuffer":i.readAsArrayBuffer(e);break;case"BinaryString":i.readAsBinaryString(e);break;case"DataURL":i.readAsDataURL(e);break;case"Text":i.readAsText(e,null===n||void 0===n?void 0:n.encoding);break;default:return a("[read_file] unknown read type!")}i.onload=()=>{const e=i.result;switch(n.as){case"ArrayBuffer":return"string"!==typeof e&&e?t(e):a("[read_file] not ArrayBuffer!");case"BinaryString":case"DataURL":case"Text":return"string"===typeof e?t(e):a("[read_file] not string!");default:return a("[read_file] unknown read type!")}}})}t.d(n,{$z:()=>i,We:()=>s,iU:()=>a})},8405:(e,n,t)=>{t.d(n,{C:()=>d});var a=t(5043),i=t(7950),s=t(9668),r=(t(8376),t(7798)),o=t(579);function d(e){const{render:n,key:t,container:d}=e;(0,a.useEffect)(()=>{const e=(new s.HJ).override("leaf",e=>(e.borderRight="1px solid #5555CC55",e.borderBottom="1px solid #5555CC55",e)).build();return e.mount(),()=>{e.unmount()}},[]);const[c,l]=(0,a.useState)(d),[_,h]=(0,a.useState)([]),[u,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(!c)return;const e=new s.qj(c);e.workspaces_rect=e=>{const n=c.getBoundingClientRect();return{x:0,y:0,w:Math.ceil(n.width+2),h:Math.ceil(n.height+2)}};const n=new r.vm(e);return n.root.keep=!0,n.on_leaves_changed=()=>{const t=[];for(const a of n.leaves){const i=e.get_cell(a);i&&!i.children.length&&(i.parentElement||n.adapter.container.appendChild(i),t.push([a,i]))}h(t)},n.confirm(),p(n),()=>{n.on_leaves_changed=void 0,n.root.release(),n.release()}},[c]);const f=(0,a.useMemo)(()=>n?(0,o.jsx)(o.Fragment,{children:_.map((e,a)=>{let[s,r]=e;return i.createPortal(n(s,r,a),r,t?t(s,r,a):a)})}):(0,o.jsx)(o.Fragment,{}),[_,n,t]);return{workspace:u,set_container:l,pairs:_,context:f}}},9683:(e,n,t)=>{t.d(n,{k:()=>On});var a=t(2614),i=t.n(a),s=t(5043),r=t(1231),o=t(9724),d=t(9528),c=t(3794),l=t(3602);function _(e,n,t){return e||(e={}),e[n]=t,e}function h(e,n,t){var a,i;return"string"!==typeof e?null:null!==(a=null===(i=new RegExp(`${n.trim()}((.|\\n)+?)${t.trim()}`,"g").exec(e))||void 0===i?void 0:i[1])&&void 0!==a?a:null}function u(e,n,t){let a=(n=new RegExp(n,"g")).exec(e);const i=[];for(;a;)t?t(a):i.push(a),a=n.exec(e);if(!t)return i}const p=/\s*(\S*)\s*:\s*(\S*)/g;function f(e,n){return"string"!==typeof e?n?void 0:[]:n?u(e.trim(),p,e=>{let[,t,a]=e;return n(t,a)}):u(e.trim(),p).map(e=>{let[,n,t]=e;return[n,t]})}var g=t(1598),m=t(5721);class v{static make(e){const n=new v(e);return this.builders.push(n),n}static check_all(){this.builders.forEach(e=>e.check())}get bot(){let e=this.entity.base.bot;return e||(e=this.entity.base.bot={id:this.entity.id,actions:{}}),e}get frames(){const{bot:e}=this;let n=e.frames;return n||(n=e.frames={}),n}get states(){const{bot:e}=this;let n=e.states;return n||(n=e.states={}),n}constructor(e){this.entity=void 0,this.entity=e}set_actions(){const{bot:e}=this;for(var n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];for(const i of t){const n="function"===typeof i?i():i;e.actions[n.action_id]=n}return this}set_frames(e,n){const{frames:t}=this;return t[""+e]=n,this}set_states(e,n){const{states:t}=this;return t[""+e]=n,this}check(){const{states:e,frames:n,bot:{actions:t},entity:a}=this,i=new Set(Object.keys(t));(0,m.R)(e,(e,n)=>{const s=(""+e).split(",");for(const t of s){!!(0,g.I6)(a.frames,e=>{let[n,a]=e;return t==""+a.state})||console.warn(`[BotBuilder::check] state "${t}" is not used in any frames in entity: "${a.id}(${a.base.name})" .`)}if(null!==n&&void 0!==n&&n.length)for(const i of n){!!(0,g.I6)(t,e=>{let[n]=e;return n==""+i})||console.warn(`[BotBuilder::check] action "${i}" of states "${e}" is not exists in entity: "${a.id}(${a.base.name})".`)}else console.warn(`[BotBuilder::check] actions of states "${e}" should not be empty, but got ${n}, entity: "${a.id}(${a.base.name})".`);i.size>0&&(null===n||void 0===n||n.forEach(e=>i.delete(e)))}),(0,m.R)(n,(e,n)=>{const s=(""+e).split(",");for(const t of s){Object.keys(a.frames).some(e=>e===t)||console.warn(`[BotBuilder::check] frame "${t}" is not exists in entity: "${a.id}(${a.base.name})".`)}if(null!==n&&void 0!==n&&n.length)for(const i of n){!!(0,g.I6)(t,e=>{let[n]=e;return n==""+i})||console.warn(`[BotBuilder::check] action "${i}" of "${e}" is not exists in entity: "${a.id}(${a.base.name})".`)}else console.warn(`[BotBuilder::check] actions of frame "${e}" should not be empty, but got ${n}, entity: "${a.id}(${a.base.name})" .`);i.size>0&&(null===n||void 0===n||n.forEach(e=>i.delete(e)))}),i.size>0&&console.warn(`[BotBuilder::check] actions "${Array.from(i)}" is not used in entity: "${a.id}(${a.base.name})"`)}set_dataset(e){return this.bot.dataset={...this.bot.dataset,...e},this}}v.builders=[];var y=t(583),b=t(4878),k=t(3845),w=t(6063),C=t(5584),x=t(6657),A=t(4827),P=t(6401),F=t(7722),T=t(309),E=t(9956);function B(e,n){const t=Number(e);return(0,E.AK)(t)?t:n}var S=t(7919);class W{constructor(){this.is_cond=!0,this._parts=[]}add(e,n,t){return"function"!==typeof e?this._parts.push(`${e}${n}${t}`):this._parts.push(e(new W)),this}not(e){return this._parts.push("!",e(new W)),this}wrap(e){return this._parts.push(e(new W)),this}one_of(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return this.wrap(n=>{for(const a of t)n=n.or(e,"==",a);return n})}not_in(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return this.wrap(n=>{for(const a of t)n.and(e,"!=",a);return n})}_any(e,n,t){if("function"===typeof e)return this.wrap(e);if(void 0!==e){if(Array.isArray(n))return this.one_of(e,...n);if(void 0!==n&&void 0!==t)return this.add(e,n,t)}return this}or(e,n,t){return this._parts.length&&this._parts.push("|"),this._any(e,n,t)}and(e,n,t){return this._parts.length&&this._parts.push("&"),this._any(e,n,t)}done(){let e=this._parts.map(e=>(0,S.Hl)(e)?e:`(${e.done()})`).join("");return e=e.replace(/\s|\n|\r/g,""),1===this._parts.length&&W.is(this._parts[0])&&(e=e.replace(/^\(|\)$/g,"")),e}}W.is=e=>!0===(null===e||void 0===e?void 0:e.is_cond);var N=t(3154),z=t(8825);function I(e,n){return{...JSON.parse(JSON.stringify(e)),...n}}function D(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];Object.assign(e,...t)}function j(e,n){const t=n.bdy?n.bdy:n.bdy=[],a=[];for(const s of t){const n=(new W).add(w.W.ItrKind,"!=",z.w7.JohnShield).and(w.W.ItrKind,"!=",z.w7.Block).and(e=>e.add(w.W.AttackerType,"==",l.D2.Ball).or(e=>e.add(w.W.AttackerType,"==",l.D2.Weapon).and(w.W.ItrKind,"!=",z.w7.WeaponSwing))).and().not_in(w.W.ItrKind,z.w7.Block,z.w7.MagicFlute,z.w7.MagicFlute2,z.w7.Pick,z.w7.PickSecretly).and().not_in(w.W.ItrEffect,N.pd.Ice2,N.pd.MFire1);e.id===y.PC.FreezeBall&&n.and(w.W.AttackerIsFreezableBall,"!=",1),D(s,{test:n.done(),actions:[{type:b.X.V_NextFrame,data:{id:"20"}}]}),a.push(I(s,{hit_flag:k._0.AllBoth,test:(new W).wrap(e=>e.add(w.W.SameTeam,"==",0).and(w.W.AttackerType,"==",l.D2.Fighter).and(w.W.ItrKind,"==",z.w7.Normal).and(w.W.ItrEffect,"!=",N.pd.Ice).and(w.W.ItrEffect,"!=",N.pd.MFire1)).or(e=>e.add(w.W.SameTeam,"==",1).and(w.W.AttackerType,"==",l.D2.Fighter).and(w.W.SameFacing,"==",0).and(w.W.ItrKind,"==",z.w7.Normal).and(w.W.ItrEffect,"!=",N.pd.Ice)).or(w.W.ItrKind,"==",z.w7.JohnShield).or(e=>e.add(w.W.SameTeam,"==",1).and(w.W.SameFacing,"==",0).and(w.W.ItrKind,"==",z.w7.WeaponSwing)).or(e=>e.add(w.W.SameTeam,"==",0).and(w.W.ItrKind,"==",z.w7.WeaponSwing)).and().not_in(w.W.ItrKind,z.w7.Block,z.w7.MagicFlute,z.w7.MagicFlute2,z.w7.Pick,z.w7.PickSecretly).and().not_in(w.W.ItrEffect,N.pd.Ice2,N.pd.MFire1).done(),actions:[{type:b.X.V_NextFrame,data:{id:"30"}}]}))}t.push(...a);const i=n.itr?n.itr:n.itr=[];for(const s of i)switch(s.kind){case z.w7.Normal:s.actions=(0,g.D8)(s.actions,{type:b.X.A_NextFrame,data:{id:"10"}});break;case z.w7.Block:t.length=0,t.push({kind:0,hit_flag:k._0.AllBoth,test:(new W).not_in(w.W.ItrKind,z.w7.Block,z.w7.MagicFlute,z.w7.MagicFlute2,z.w7.Pick,z.w7.PickSecretly).and().not_in(w.W.ItrEffect,N.pd.Ice2,N.pd.MFire1).done(),z:s.z,l:s.l,x:s.x,y:s.y,w:s.w,h:s.h,actions:[{type:b.X.V_NextFrame,data:{id:"30"}},{type:b.X.V_Sound,data:{path:e.base.dead_sounds||[]}}]})}i.push()}var H=t(302);function G(e,n,t){if(!t)return;if("string"!==typeof e.id)return;const[a,i]=t.get(e.id)||[0,0];"hit"===n?(a>0&&(e.mp=a),i>0&&(e.hp=i)):"next"===n&&(a<0&&(e.mp=-a),i<0&&(e.hp=-i))}const $=(e,n,t)=>{if(""+e==="1000")return{id:y.Vp.Gone};if(""+e==="999")return{id:y.Vp.Auto};if(""+e==="-999")return{id:y.Vp.Auto,facing:y.pg.Backward};if(""+e==="0")return{};if("number"===typeof e){if(e>=1100&&e<=1299)return{id:y.Vp.Auto};if(e<=-1100&&e>=-1299)return{id:y.Vp.Auto,facing:y.pg.Backward};if(e<0){const a={id:""+-e,facing:y.pg.Backward};return G(a,n,t),a}}if("string"===typeof e&&e.startsWith("-")){const a={id:e.substring(1),facing:y.pg.Backward};return G(a,n,t),a}const a={id:""+e};return G(a,n,t),a};var X=t(2779);const R=(new W).and(C.P.HP,">",0).done();function K(e,n,t){e.hp=500;let a=(0,X.s)(e,"weapon_broken_sound");a&&(a=(a+".mp3").replace(/\\/g,"/"),e.dead_sounds=[a]);let i=(0,X.s)(e,"weapon_drop_sound");i&&(i=(i+".mp3").replace(/\\/g,"/"),e.drop_sounds=[i]);let s=(0,X.s)(e,"weapon_hit_sound");s&&(s=(s+".mp3").replace(/\\/g,"/"),e.hit_sounds=[s]);const r={id:t.id,type:l.D2.Ball,base:e,frames:n};return(0,m.R)(r.frames,(e,n)=>{var a;const i=(0,X.$)(n,"hit_j");0!==i&&(n.vzm=F.h.Extra,n.dvz=B(i,50)-50);const o=(0,X.$)(n,"hit_a");o&&(n.hp=o/2);const d=(0,X.$)(n,"hit_d");d&&d!==n.id&&(n.on_dead=$(d));const c=(0,X.$)(n,"hit_Fa");switch(c&&(n.behavior=c,n.behavior_name="FrameBehavior."+x.q[c]),c){case x.q.AngelBlessing:n.dvx=y.Tc.ANGEL_BLESSING_MAX_VX,n.acc_x=y.Tc.ANGEL_BLESSING_ACC_X,n.vxm=F.h.AccTo,n.dvz=y.Tc.DEFAULT_OPOINT_SPEED_Z,n.acc_z=y.Tc.ANGEL_BLESSING_ACC_Z,n.vzm=F.h.AccTo,n.dvy=y.Tc.ANGEL_BLESSING_MAX_VY,n.acc_y=y.Tc.ANGEL_BLESSING_ACC_Y,n.vym=F.h.AccTo,n.ctrl_x=n.ctrl_y=n.ctrl_z=1,n.itr=(0,g.D8)(n.itr,{kind:y.w7.Heal,x:25,y:13,w:32,h:34,injury:100,hit_flag:k._0.Ally|k._0.Fighter,l:24,z:-12,actions:[{type:b.X.A_NextFrame,data:{id:"60"}}],test:(new W).and(w.W.VictimIsChasing,"==",1).done()});break;case x.q.JohnChase:n.dvx=y.Tc.JOHN_CHASE_MAX_VX,n.acc_x=y.Tc.JOHN_CHASE_ACC_X,n.vxm=F.h.AccTo,n.dvz=y.Tc.DEFAULT_OPOINT_SPEED_Z,n.acc_z=y.Tc.JOHN_CHASE_ACC_Z,n.vzm=F.h.AccTo,n.dvy=y.Tc.JOHN_CHASE_MAX_VY,n.acc_y=y.Tc.JOHN_CHASE_ACC_Y,n.vym=F.h.AccTo,n.ctrl_x=n.ctrl_y=n.ctrl_z=1;break;case x.q.DennisChase:switch(n.dvx=y.Tc.DENNIS_CHASE_MAX_VX,n.acc_x=y.Tc.DENNIS_CHASE_ACC_X,n.vxm=F.h.AccTo,n.dvz=y.Tc.DEFAULT_OPOINT_SPEED_Z,n.acc_z=y.Tc.DENNIS_CHASE_ACC_Z,n.vzm=F.h.AccTo,n.dvy=y.Tc.DENNIS_CHASE_MAX_VY,n.acc_y=y.Tc.DENNIS_CHASE_ACC_Y,n.vym=F.h.AccTo,n.ctrl_x=n.ctrl_y=n.ctrl_z=1,n.on_dead={id:"5"},n.id){case"1":n.key_down={F:{id:"3",wait:"i",expression:R}};break;case"2":n.key_down={F:{id:"4",wait:"i",expression:R}};break;case"3":n.key_down={B:{id:"1",wait:"i",expression:R}};break;case"4":n.key_down={B:{id:"2",wait:"i",expression:R}}}break;case x.q._03:break;case x.q.AngelBlessingStart:!function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.centerx,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.centery;e.opoint=(0,g.D8)(e.opoint,{kind:A.E.Normal,oid:y.PC.JanChaseh,x:n,y:t,action:{id:"0"},multi:{type:P.m.AccordingAllies,min:1},spreading:y.Xh.AngelBlessing})}(n);break;case x.q.DevilJudgementStart:!function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.centerx,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.centery;e.opoint=(0,g.D8)(e.opoint,{kind:A.E.Normal,oid:y.PC.JanChase,x:n,y:t,dvy:6,action:{id:"0"},multi:{type:P.m.AccordingEnemies,min:1},spreading:y.Xh.JanDevilJudgement})}(n);break;case x.q.ChasingSameEnemy:switch(n.dvx=y.Tc.DISATER_CHASE_MAX_VX,n.acc_x=y.Tc.DISATER_CHASE_ACC_X,n.vxm=F.h.AccTo,n.dvz=y.Tc.DEFAULT_OPOINT_SPEED_Z,n.acc_z=y.Tc.DISATER_CHASE_ACC_Z,n.vzm=F.h.AccTo,n.dvy=y.Tc.DISATER_CHASE_MAX_VY,n.acc_y=y.Tc.DISATER_CHASE_ACC_Y,n.vym=F.h.AccTo,n.ctrl_x=n.ctrl_z=1,t.id){case y.PC.FirzenChasef:case y.PC.FirzenChasei:n.on_landing={id:"60"};break;case y.PC.JanChase:n.on_landing={id:"10"}}break;case x.q.BatStart:n.opoint=(0,g.D8)(n.opoint,{kind:A.E.Normal,oid:y.PC.BatChase,x:n.centerx,y:n.centery,action:{id:"0"},multi:{type:P.m.AccordingEnemies,min:3},spreading:y.Xh.Bat});break;case x.q.FirzenDisasterStart:L(n);break;case x.q.JohnBiscuitLeaving:n.dvx=15,n.acc_x=2,n.vxm=F.h.AccTo;break;case x.q.FirzenVolcanoStart:L(n,n.centerx,-79),n.opoint=(0,g.D8)(n.opoint,{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx,y:24,action:{id:"109"}},{kind:A.E.Normal,oid:y.PC.FreezeColumn,x:135,y:24,action:{id:"100"}},{kind:A.E.Normal,oid:y.PC.FreezeColumn,x:135,y:24,z:-60,dvz:-4,action:{id:"100"}},{kind:A.E.Normal,oid:y.PC.FreezeColumn,x:135,y:24,z:60,dvz:4,action:{id:"100"}},{kind:A.E.Normal,oid:y.PC.FreezeColumn,x:-45,y:24,action:{id:"100",facing:y.pg.Backward}},{kind:A.E.Normal,oid:y.PC.FreezeColumn,x:-45,y:24,z:-60,dvz:-4,action:{id:"100",facing:y.pg.Backward}},{kind:A.E.Normal,oid:y.PC.FreezeColumn,x:-45,y:24,z:60,dvz:4,action:{id:"100",facing:y.pg.Backward}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx,y:26,z:0,action:{id:"54"}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx-25,y:26,z:0,action:{id:"54"}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx+25,y:26,z:0,action:{id:"54",facing:2}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx-50,y:26,z:0,action:{id:"54"}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx+50,y:26,z:0,action:{id:"54",facing:2}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx-38,y:26,z:-15,action:{id:"54"}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx+38,y:26,z:-15,action:{id:"54",facing:2}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx-38,y:26,z:15,action:{id:"54"}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx+38,y:26,z:15,action:{id:"54",facing:2}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx+10,y:26,z:25,action:{id:"54"}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx-10,y:26,z:25,action:{id:"54",facing:2}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx+10,y:26,z:-25,action:{id:"54"}},{kind:A.E.Normal,oid:y.PC.FirenFlame,x:n.centerx-10,y:26,z:-25,action:{id:"54",facing:2}});break;case x.q.Bat:n.dvx=y.Tc.BAT_CHASE_MAX_VX,n.acc_x=y.Tc.BAT_CHASE_ACC_X,n.vxm=F.h.AccTo,n.dvz=y.Tc.DEFAULT_OPOINT_SPEED_Z,n.acc_z=y.Tc.BAT_CHASE_ACC_Z,n.vzm=F.h.AccTo,n.dvy=y.Tc.BAT_CHASE_MAX_VY,n.acc_y=y.Tc.BAT_CHASE_ACC_Y,n.vym=F.h.AccTo,n.ctrl_x=n.ctrl_y=n.ctrl_z=1;break;case x.q.JulianBallStart:n.opoint=(0,g.D8)(n.opoint,{kind:A.E.Normal,oid:y.PC.JulianBall,x:n.centerx,y:n.centery,dvx:8,action:{id:"50"}});break;case x.q.JulianBall:{n.dvx=y.Tc.DENNIS_CHASE_MAX_VX,n.acc_x=y.Tc.DENNIS_CHASE_ACC_X,n.vxm=F.h.AccTo,n.dvz=y.Tc.DEFAULT_OPOINT_SPEED_Z,n.acc_z=y.Tc.DENNIS_CHASE_ACC_Z,n.vzm=F.h.AccTo,n.dvy=y.Tc.DENNIS_CHASE_MAX_VY,n.acc_y=y.Tc.DENNIS_CHASE_ACC_Y,n.vym=F.h.AccTo,n.ctrl_x=n.ctrl_y=n.ctrl_z=1;const e=Number(n.id);if(e>=50&&e<=59){n.key_down={F:{id:""+(e-50),wait:"i",expression:R}};break}if(e>=1&&e<=9){n.key_down={B:{id:""+(e+50),wait:"i",expression:R}};break}break}}if(n.itr)for(const t of n.itr)t.kind===y.w7.JohnShield&&d&&(t.actions=(0,g.D8)(t.actions,{type:b.X.A_NextFrame,test:(new W).add(w.W.VictimType,"==",l.D2.Fighter).done(),data:{id:d}})),s&&t.kind!==y.w7.Whirlwind&&t.kind!==y.w7.Freeze&&t.kind!==y.w7.Block&&t.kind!==y.w7.Heal&&(t.actions=(0,g.D8)(t.actions,{type:b.X.A_Sound,data:{path:[s]}}));switch(n.gravity_enabled=null!==(a=n.gravity_enabled)&&void 0!==a&&a,n.state){case y.Fb.Ball_Flying:case y.Fb.Ball_Hitting:return j(r,n);case y.Fb.Ball_3005:return function(e,n){if(n.bdy)for(const t of n.bdy)t.actions=t.actions||[],t.actions.push({type:b.X.V_NextFrame,test:(new W).add(w.W.AttackerState,"==",H.Fb.Ball_3005).or(w.W.ItrKind,"==",z.w7.JohnShield).done(),data:{id:"20"}});(0,T.X)(n.itr,e=>{e.kind===z.w7.Normal&&(e.actions=(0,g.D8)(e.actions,{type:b.X.A_NextFrame,test:(new W).add(w.W.VictimState,"==",H.Fb.Ball_3005).done(),data:{id:"20"}}))})}(0,n);case y.Fb.Ball_3006:return function(e,n){for(const t of n.bdy||[])t.actions=(0,g.D8)(t.actions,{type:b.X.V_NextFrame,test:(new W).one_of(w.W.AttackerState,H.Fb.Ball_3005,H.Fb.Ball_3006).or(w.W.ItrKind,"==",z.w7.JohnShield).done(),data:{id:"20"}});(0,T.X)(n.itr,e=>{e.kind===z.w7.Normal&&(e.actions=(0,g.D8)(e.actions,{type:b.X.A_NextFrame,test:(new W).one_of(w.W.VictimState,H.Fb.Ball_3005,H.Fb.Ball_3006).done(),data:{id:"20"}}))})}(0,n)}(0,T.X)(n.itr,e=>{var n;switch(e.kind){case y.w7.Normal:case y.w7.JohnShield:case y.w7.CharacterThrew:case y.w7.WeaponSwing:null!==(n=r.base.hit_sounds)&&void 0!==n&&n.length&&(e.actions=(0,g.D8)(e.actions,{type:b.X.A_Sound,data:{path:r.base.hit_sounds}}));case y.w7.Catch:case y.w7.Pick:case y.w7.ForceCatch:case y.w7.SuperPunchMe:case y.w7.PickSecretly:case y.w7.Heal:case y.w7.MagicFlute:case y.w7.MagicFlute2:case y.w7.Block:case y.w7.Whirlwind:case y.w7.Freeze:}})}),r}function L(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.centerx,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.centery;e.opoint=(0,g.D8)(e.opoint,{kind:A.E.Normal,oid:[y.PC.FirzenChasef,y.PC.FirzenChasei],x:n,y:t,dvy:6,action:{id:"0"},multi:{type:P.m.AccordingEnemies,min:4},spreading:y.Xh.FirzenDisater})}var M=t(8602),O=t(4981);function V(e,n,t){const a=new RegExp(`${n.trim()}((.|\\n)+?)${t.trim()}`,"g"),i=[],s={blocks:u(e,a).map(e=>(i.push([e.index,e.index+e[0].length]),e[1])),remains:""};if(i.length){let n=0;for(const[t,a]of i)s.remains+=e.substring(n,t),n=a;s.remains+=e.substring(n)}else s.remains=e;return s}var J=function(e){return e[e.Str=0]="Str",e[e.Int=1]="Int",e[e.Int_Int=2]="Int_Int",e}(J||{});class U{constructor(){this._cells=[]}str(e){return this._cells.push([e,J.Str]),this}int(e){return this._cells.push([e,J.Int]),this}int_2(e){return this._cells.push([e,J.Int_Int]),this}read(e,n){let t=e;for(const[a,i]of this._cells)switch(i){case J.Str:{const e=`${a.toString()}\\s*:\\s*(\\S+)[\\s|\\n]*`,i=new RegExp(e).exec(t);if(!i)break;n[a]=i[1],t=t.slice(0,i.index)+t.slice(i[0].length);break}case J.Int:{const e=`${a.toString()}\\s*:\\s*(\\d+)[\\s|\\n]*`,i=new RegExp(e).exec(t);if(!i)break;n[a]=Number(i[1]),t=t.slice(0,i.index)+t.slice(i[0].length);break}case J.Int_Int:{const e=`${a.toString()}\\s*:\\s*(\\d+)\\s*(\\d+)[\\s|\\n]*`,i=new RegExp(e).exec(t);if(!i)break;n[a]=[Number(i[1]),Number(i[2])],t=t.slice(0,i.index)+t.slice(i[0].length);break}}return[n,t]}}const Y=function(e){switch(""+e){case"4706":return"rgb(16,79,16)";case"16835":return"rgb(66,56,24)";case"21096":return"rgb(90,78,75)";case"25356":return"rgb(103,103,103)";case"29582":return"rgb(119,119,119)";case"33580":return"rgb(135,107,103)";case"37770":return"rgb(154,110,90)";case"37773":return"rgb(151,119,111)";case"34816":return"rgb(143,7,7)";case"40179":case"40179b":return"rgb(159,163,159)"}if((0,S.Hl)(e))return e;const n=e>>11<<3,t=(e>>6&31)<<3,a=(31&e)<<3;return"rgb("+(n+(n>64||0===n?7:0))+","+(t+(t>64||0===t?7:0)+(e>>5&1&&t>80?4:0))+","+(a+(a>64||0===a?7:0))+")"};function q(e,n){var t;const[a]=(new U).str("name").int("width").int_2("zboundary").str("shadow").int_2("shadowsize").read(e,{}),i=(0,X.$)(a,"width"),[s,r]=(0,X.$)(a,"zboundary");a.left=0,a.right=i,a.far=2*(s-M.T.CLASSIC_SCREEN_HEIGHT),a.near=2*(r-M.T.CLASSIC_SCREEN_HEIGHT);const o={type:"background",id:null!==(t=null===n||void 0===n?void 0:n.id)&&void 0!==t?t:a.name,base:a,layers:[]};o.base.name=o.base.name.replace(/_/g," "),o.base.shadow=o.base.shadow.replace(/.bmp$/,".png").replace(/\\/g,"/");const{blocks:d,remains:c}=V(e,"layer:","layer_end");e=c;let l=M.T.CLASSIC_SCREEN_HEIGHT;for(const h of d){const[e,n]=h.trim().split(/\n|\r/g).filter(e=>e).map(e=>e.trim()),t={};for(const[o,d]of f(n)){var _;t[o]=null!==(_=B(d))&&void 0!==_?_:d}(0,X.$)(t,"transparency");const a=(0,X.$)(t,"y"),i=(0,X.$)(t,"cc"),s=(0,X.$)(t,"c1"),r=(0,X.$)(t,"c2"),c=(0,X.$)(t,"rect"),u={...t,file:e.replace(/.bmp$/,".png").replace(/\\/g,"/"),y:M.T.CLASSIC_SCREEN_HEIGHT-a,z:o.layers.length-d.length};l=(0,O.jk)(u.y,l),c?(u.absolute=1,u.color=Y(c),delete u.file):"number"===typeof i&&"number"===typeof s&&"number"===typeof r&&(u.cc=2*i,u.c1=2*s,u.c2=2*r+1),o.layers.push(u)}return n&&n.file.startsWith("bg/template")?o.base.group=[]:o.base.group=[y.yM.Regular],o}function Z(e,n){return{id:"",type:l.D2.Entity,base:e,frames:n}}var Q=t(1649);function ee(e,n,t){const a="number"===typeof e[n]?e[n]:t;return delete e[n],a}function ne(e,n){return(Array.isArray(e)?e:[e]).forEach(n),e}function te(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return t.length?Array.isArray(e)?[...e,...t]:e?[e,...t]:[...t]:e}class ae{constructor(e){this.frame=void 0,this.frame=e}init(e){return this.frame=e,this}keydown(e){this.frame.key_down=this.frame.key_down||{};for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return this.frame.key_down[e]=te(this.frame.key_down[e],...t),this}hit(e){this.frame.hit=this.frame.hit||{};for(var n=arguments.length,t=new Array(n>1?n-1:0),a=1;a<n;a++)t[a-1]=arguments[a];return this.frame.hit[e]=te(this.frame.hit[e],...t),this}}const ie=/\.[^.]*$/,se=e=>String.fromCharCode(98+e);const re=["Fa","Fj","Da","Dj","Ua","Uj","ja"],oe=(e,n)=>{e.key_down=e.key_down||{},e.key_down.B={id:n,wait:"i",facing:y.pg.Backward}};function de(e,n){var t,a;const i=ee(e,"walking_frame_rate",3),s=ee(e,"running_frame_rate",3),r=ee(e,"walking_speed",0),o=ee(e,"walking_speedz",0),d=ee(e,"running_speed",0),c=ee(e,"running_speedz",0),h=ee(e,"heavy_walking_speed",0),u=ee(e,"heavy_walking_speedz",0),p=ee(e,"heavy_running_speed",0),f=ee(e,"heavy_running_speedz",0);ee(e,"rowing_height",0);e.jump_height&&(e.jump_height=(0,g.LI)(e.jump_height*e.jump_height/3.5)),e.dash_height&&(e.dash_height=(0,g.LI)(e.dash_height*e.dash_height/3.5)),e.rowing_height&&(e.rowing_height=(0,g.LI)(e.rowing_height*e.rowing_height/3.5)),e.dash_distance&&(e.dash_distance/=2),e.jump_distance&&(e.jump_distance/=2),e.rowing_distance&&(e.rowing_distance/=2),e.fall_value=M.T.DEFAULT_FALL_VALUE_MAX,e.defend_value=M.T.DEFAULT_DEFEND_VALUE_MAX;const v={},k=new Map;(0,m.R)(n,(e,n)=>{k.set(e,function(e){const n=(0,X.$)(e,"mp");if(!(0,E.AK)(n))return[0,0];if(n<1e3&&n>-1e3)return[n,0];const t=n%1e3;return[t,(n-t)/100]}(n))});for(const[l,z]of(0,m.R)(n)){if(Array.isArray(z.next))for(const n of z.next)G(n,"next",k);else G(z.next,"next",k);const e=(0,X.$)(z,"hit_a");e&&(z.hit=_(z.hit,"a",$(e,"hit",k)));const m=(0,X.$)(z,"hit_j");m&&(z.hit=_(z.hit,"j",$(m,"hit",k)));const T=(0,X.$)(z,"hit_d");T&&(z.hit=_(z.hit,"d",$(T,"hit",k))),re.forEach(e=>{const n=(0,X.$)(z,`hit_${e}`);if(!(0,S.Hl)(n)&&!(0,E.AK)(n))return;if("0"===n||0===n)return;z.hit||(z.hit={}),z.seqs||(z.seqs={});const t=$(n,"hit",k);"Fa"===e||"Fj"===e?(z.seqs["L"+e[1]]={...t,facing:t.facing===y.pg.Backward?y.pg.Right:y.pg.Left},z.seqs["R"+e[1]]={...t,facing:(t.facing,y.pg.Backward,y.pg.Right)}):z.seqs[e]=t});const B=new ae(z);switch(Number(z.id)){case 0:case 1:case 2:case 3:case 4:case 112:case 100:case 108:case 180:case 183:case 184:case 185:case 186:case 189:case 190:case 191:break;case 5:case 6:case 7:case 8:oe(z),B.hit("a",{id:"45",facing:y.pg.Ctrl,expression:(new W).add(C.P.Holding_W_Type,"==",y.$5.Baseball).or(e=>e.add(C.P.Holding_W_Type,"==",y.$5.Knife).and(C.P.PressFB,"!=",0)).done()},{id:["20","25"],facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Knife,y.$5.Stick).done()},{id:"55",facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Drink).done()},{id:"70",facing:y.pg.Ctrl,expression:(new W).add(C.P.RequireSuperPunch,"==",1).done()},{id:["60","65"],facing:y.pg.Ctrl}).hit("j",{id:"210"}).hit("d",{id:"110"}).hit("FF",{id:"running_0"}),z.dvx=r/2,z.dvz=o,z.ctrl_z=1,z.ctrl_x=1;break;case 9:case 10:case 11:B.hit("a",{id:"45",expression:(new W).add(C.P.Holding_W_Type,"==",y.$5.Baseball).or(e=>e.add(C.P.PressFB,"==",1).and(C.P.Holding_W_Type,"!=",y.$5.None)).done()},{id:"55",expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Drink).done()},{id:"35",expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Knife,y.$5.Stick).done()},{id:"85"}).hit("j",{id:"213"}).hit("d",{id:"102"}).keydown("B",{id:"218"}),z.dvx=Number((d/2).toFixed(1)),z.dvz=c,z.ctrl_z=1;break;case 12:case 13:case 14:case 15:oe(z),z.hit=z.hit||{},z.hit.FF={id:"heavy_obj_run_0"},z.hit.a=te(z.hit.a,{id:"50",facing:y.pg.Ctrl}),z.dvx=h/2,z.dvz=u,z.ctrl_x=z.ctrl_z=1;break;case 16:case 17:case 18:z.hit=z.hit||{},z.hold=z.hold||{},z.key_down=z.key_down||{},z.key_down.B={id:"19"},z.hit.a=te(z.hit.a,{id:"50"}),z.dvx=Number((p/2).toFixed(1)),z.dvz=f,z.ctrl_z=1;break;case 110:case 111:var w;if(oe(z),null!==(w=z.bdy)&&void 0!==w&&w.length)for(const n of z.bdy)n.actions=(0,g.D8)(n.actions,{type:b.X.V_BrokenDefend,data:{id:"112"}},{type:b.X.V_Defend,data:{id:"111"}});break;case 210:case 211:case 212:oe(z),z.hit=z.hit||{},z.key_down=z.hit||{},z.hold=z.hold||{},"211"===l&&(z.jump_flag=1),"212"===l&&ce(z),z.key_down.B={facing:y.pg.Ctrl};break;case 213:case 214:case 216:case 217:"213"===l&&n[214]&&oe(z,"214"),"216"===l&&n[217]&&oe(z,"217"),"214"===l&&n[213]&&oe(z,"213"),"217"===l&&n[216]&&oe(z,"216"),z.state!==y.Fb.Dash||"213"!==l&&"216"!==l||(z.key_down=z.key_down||{},z.key_down.a=te(z.key_down.a,{id:"52",facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Baseball,y.$5.Drink).done()},{id:"40",facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Knife,y.$5.Stick).done()},{id:"90"})),z.state===y.Fb.Jump&&(ce(z),z.state=y.Fb.Dash);break;case 120:case 121:case 122:case 123:if(z.cpoint){var x,A;z.cpoint.vaction&&((null===(x=z.cpoint)||void 0===x?void 0:x.vaction).facing=y.pg.OpposingCatcher);const e=(0,X.$)(z.cpoint,"aaction"),n=(0,X.$)(z.cpoint,"taction"),t=null===(A=z.hit)||void 0===A?void 0:A.a;let a,i;if(n&&(a=[{...$(n),facing:y.pg.Ctrl,expression:(new W).add(C.P.Catching,"==",1).and().wrap(e=>e.add(C.P.PressFB,"!=",0).or(C.P.PressUD,"!=",0)).done()}]),e&&(i={...$(e),expression:(new W).add(C.P.Catching,"==",1).done()}),Array.isArray(t))a&&t.unshift(...a),i&&t.unshift(i);else{let e=0;if(t&&++e,a&&++e,i&&++e,e>=2){const e=[];t&&e.push(t),a&&e.push(...a),i&&e.push(i),z.hit=z.hit||{},z.hit.a=te(z.hit.a,...e)}else 1===e&&(z.hit=z.hit||{},t?z.hit.a=te(z.hit.a,t):a?z.hit.a=te(z.hit.a,...a):i&&(z.hit.a=te(z.hit.a,i)))}}break;case 232:case 233:case 234:null!==(t=z.cpoint)&&void 0!==t&&t.vaction&&((null===(a=z.cpoint)||void 0===a?void 0:a.vaction).facing=y.pg.OpposingCatcher);break;case 181:case 182:B.hit("j",{id:"100",expression:(new W).add(C.P.HP,">",0).and(C.P.LastestCollidedItrKind,"!=",y.w7.MagicFlute).and(C.P.LastestCollidedItrKind,"!=",y.w7.MagicFlute2).done()});break;case 187:case 188:z.hit||(z.hit={}),z.hit.j=te(z.hit.j,{id:"108",expression:(new W).add(C.P.HP,">",0).done()});break;case 200:z.state=y.Fb.Frozen;break;case 215:const e=[{id:"213",expression:(new W).add(C.P.PressLR,"==",-1).done(),facing:y.pg.Left},{id:"213",expression:(new W).add(C.P.PressLR,"==",1).done(),facing:y.pg.Right},{id:"214",expression:(new W).add(C.P.TrendX,"==",-1).done()},{id:"213",expression:(new W).add(C.P.TrendX,"==",1).done()}];z.hit=z.hit||{},z.hit.d={id:"102",facing:y.pg.Ctrl},z.hit.j=e}switch(z.state){case y.Fb.Frozen:ne(z.next,e=>{const t="string"===typeof e.id&&n[e.id];t&&t.state!==y.Fb.Frozen&&(e.blink_time=60)});break;case y.Fb.Standing:z.hit=z.hit||{},z.hold=z.hold||{},z.key_down=z.key_down||{},z.hit.a=[{id:"45",facing:y.pg.Ctrl,expression:(new W).add(C.P.Holding_W_Type,"==",y.$5.Baseball).or(e=>e.add(C.P.Holding_W_Type,"==",y.$5.Knife).and(C.P.PressFB,"!=",0)).done()},{id:["20","25"],facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Knife,y.$5.Stick).done()},{id:"55",expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Drink).done(),facing:y.pg.Ctrl},{id:"70",expression:(new W).add(C.P.RequireSuperPunch,"==",1).done()},{id:["60","65"],facing:y.pg.Ctrl}],z.hit.j={id:"210",facing:y.pg.Ctrl},z.hit.d={id:"110",facing:y.pg.Ctrl},z.key_down.U=z.key_down.D=z.key_down.L=z.key_down.R={id:"walking_0",facing:y.pg.Ctrl},z.hit.FF=z.hit.FF={id:"running_0"};break;case y.Fb.BurnRun:case y.Fb.Z_Moveable:z.dvz=c,z.ctrl_z=1;break;case y.Fb.Defend:var P;if(null!==(P=z.bdy)&&void 0!==P&&P.length)for(const e of z.bdy){var F;e.kind=Q.aW.Defend,e.kind_name=Q.aW[e.kind],null!==(F=e.actions)&&void 0!==F&&F.find(e=>e.type===b.X.V_BrokenDefend)||(e.actions=(0,g.D8)(e.actions,{type:b.X.V_BrokenDefend,data:{id:"112"}}))}break;case y.Fb.Walking:"12"!==l&&"13"!==l&&"14"!==l&&"15"!==l&&(z.hit=z.hit||{},z.hit.a=[{id:["45"],facing:y.pg.Ctrl,expression:(new W).add(C.P.Holding_W_Type,"==",y.$5.Baseball).or(e=>e.add(C.P.Holding_W_Type,"==",y.$5.Knife).and(C.P.PressFB,"!=",0)).done()},{id:["20","25"],facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Knife,y.$5.Stick).done()},{id:"55",expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Drink).done(),facing:y.pg.Ctrl},{id:"70",expression:(new W).add(C.P.RequireSuperPunch,"==",1).done()},{id:["60","65"],facing:y.pg.Ctrl}],z.hit.j={id:"210"},z.hit.d={id:"110"},z.hit.FF={id:"running_0"},z.dvx=r/2,z.dvz=o,z.ctrl_x=z.ctrl_z=1,z.wait=2*i-1),oe(z),v[z.name]=v[z.name]||[],v[z.name].push(z),delete n[l];break;case y.Fb.Running:"16"!==l&&"17"!==l&&"18"!==l&&(z.hit=z.hit||{},z.hit.a=[{id:["45"],expression:(new W).add(C.P.Holding_W_Type,"==",y.$5.Baseball).or(e=>e.add(C.P.PressFB,"==",1).and(C.P.Holding_W_Type,"!=",y.$5.None)).done()},{id:"55",expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Drink).done()},{id:"35",expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Knife,y.$5.Stick).done(),facing:y.pg.Ctrl},{id:"85"}],z.hit.j={id:"213"},z.hit.d={id:"102"},z.key_down=z.key_down||{},z.key_down.B={id:"218"},z.dvx=Number((d/2).toFixed(1)),z.dvz=c,z.ctrl_z=1,z.wait=2*s-1),v[z.name]=v[z.name]||[],v[z.name].push(z),delete n[l];break;case y.Fb.NextAsLanding:z.next={id:"94"}}}const T=(e,t)=>{for(let a=0;a<2*t.length-2;++a){const i=a<t.length?t[a]:{...t[2*(t.length-1)-a]};i.id=`${e}_${a}`,i.next={id:`${e}_${a===2*t.length-3?0:a+1}`},i.state!==y.Fb.Standing&&i.state!==y.Fb.Walking||(i.next.facing=y.pg.Ctrl),n[i.id]=i}};for(const l in v)T(l,v[l]);const B={standing:"0",heavy_obj_walk:["heavy_obj_walk_0"],picking_light:"115",picking_heavy:"117",ice:"200",fire:["203","205"],injured:{[-1]:"220",1:"222"},dizzy:"226",lying:{[-1]:"230",1:"231"},grand_injured:{[-1]:["220"],1:["222"]},in_the_skys:["212"],critical_hit:{[-1]:["180"],1:["186"]},falling:{[-1]:["181","182","183"],1:["187","188","189"]},bouncing:{[-1]:["184","185"],1:["190","191"]},landing_1:"215",landing_2:"219"},N={id:"",type:l.D2.Fighter,base:e,indexes:B,frames:n};return function(e){const n=[];for(const t in e){const{state:a,id:i}=e[t];a===y.Fb.TransformToCatching_Begin&&n.push(i)}if(n.length){const t=e=>{!e||Array.isArray(e)||!e.id||Array.isArray(e.id)||n.indexOf(e.id)<0||(e.expression=(new W).add(C.P.HAS_TRANSFORM_DATA,"==",1).done())};for(const n in e){const a=e[n],{hit:i}=a;if(i&&(t(i.a),t(i.j),t(i.d),a.seqs))for(const e in a.seqs)t(a.seqs[e])}}}(N.frames),function(e){const n=Object.keys(e.base.files);if(!n.length||n.length%2!==0)return;const t=n.sort().map(n=>e.base.files[n]),a=[0],i=t[0].path.replace(ie,"");for(let o=0;o<16;++o){const e=se(o),n=t.findIndex(n=>n.path.replace(ie,"")===i+e);if(n<1)break;a.push(n)}const s=a.reduce((e,n,t,a)=>{if(0===t)return n;const i=n-a[t-1];return 1===t?i:e===i?e:null},0);if(!s)return;let r=!0;for(let o=0;o<s;++o){const e=t[o];if(r=!a.slice(1).map(e=>t[e+o]).some((n,t)=>!(n.path.replace(ie,"")===e.path.replace(ie,"")+se(t))||n.col!==e.col||n.row!==e.row||n.cell_w!==e.cell_w||n.cell_h!==e.cell_h),!r)return}for(let o=0;o<s;++o)t[o].variants=a.slice(1).map(e=>t[e+o].id)}(N),N}function ce(e){e.key_down=e.key_down||{},e.key_down.a=te({id:"52",facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Baseball,y.$5.Drink).or(e=>e.add(C.P.PressFB,"!=",0).and(C.P.Holding_W_Type,"!=",y.$5.None)).done()},{id:"30",facing:y.pg.Ctrl,expression:(new W).one_of(C.P.Holding_W_Type,y.$5.Knife,y.$5.Stick).done()},{id:"80",facing:y.pg.Ctrl})}const le=.033333;function _e(e,n,t){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:le,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5?arguments[5]:void 0,r=arguments.length>6?arguments[6]:void 0;return o=>{const d=new W;t>0&&d.add(y.PB.MP,">=",t);const c={x:1,z:0,min_x:i,max_x:s},l=[c];r&&r>0&&l.push({...c,z:-r},{...c,z:r});const _={action_id:e,desire:y.Tc.desire(a),status:[y.Sl.Chasing],e_ray:l,expression:t>0?d.done():void 0,keys:n};return o?o(_,d):_}}const he=120,ue="d>a";function pe(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:he,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return _e(ue,[y.kG.d,"F",y.kG.a],e,n,t,a,i)}pe.ID=ue,pe.MIN_X=he;const fe=120,ge="d>j";function me(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fe,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return _e(ge,[y.GK.d,"F",y.GK.j],e,n,t,a,i)}function ve(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:le;const i=[y.GK.d];switch(e[1]){case"^":i.push(y.kG.U);break;case"v":i.push(y.kG.D);break;case">":i.push("F");break;case"j":i.push(y.kG.j)}switch(e[2]){case"a":i.push(y.kG.a);break;case"j":i.push(y.kG.j)}return e=>{const s=new W;t>0&&s.add(y.PB.MP,">=",t);const r={action_id:n,desire:y.Tc.desire(a),status:[y.Sl.Chasing],expression:t>0?s.done():void 0,keys:i};return e?e(r,s):r}}me.ID=ge,me.MIN_X=fe;const ye={walkings:(0,g.BY)(0,5,1).map(e=>"walking_"+e),standings:(0,g.BY)(0,3,1).map(e=>""+e),runnings:(0,g.BY)(0,3,1).map(e=>"running_"+e),punchs:(0,g.BY)(60,69),rowings:(0,g.BY)(103,107),super_punch:(0,g.BY)(70,79)};var be=t(6961);function ke(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(var a=arguments.length,i=new Array(a>3?a-3:0),s=3;s<a;s++)i[s-3]=arguments[s];return a=>{const s=new W;t>0&&s.add(y.PB.MP,">=",t);const r={action_id:e,desire:y.Tc.desire(n),status:[y.Sl.Chasing],expression:t>0?s.done():void 0,e_ray:[{x:1,z:0}],keys:i.length?i:[y.GK.Attack]};return a?a(r,s):r}}function we(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:le;return i=>{const s=new W;t>0&&s.add(y.PB.MP,">=",t);const r={action_id:e,desire:y.Tc.desire(a),status:[y.Sl.Chasing],expression:t>0?s.done():void 0,keys:n};return i?i(r,s):r}}const Ce=-10,xe=120,Ae="d^a";function Pe(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ce,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:xe;const i=(new W).add(y.PB.MP,">=",e);return{action_id:Ae,desire:y.Tc.desire(n),status:[y.Sl.Chasing],e_ray:[{x:1,z:0,min_x:t,max_x:a}],expression:e>0?i.done():void 0,keys:[y.GK.d,y.GK.U,y.GK.a]}}Pe.ID=Ae,Pe.MIN_X=Ce,Pe.MAX_X=xe;const Fe=-10,Te=120,Ee="dva";function Be(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fe,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Te;return i=>{const s=(new W).add(y.PB.MP,">=",e),r={action_id:Ee,desire:y.Tc.desire(n),status:[y.Sl.Chasing],e_ray:[{x:1,z:0,min_x:t,max_x:a,max_d:900}],expression:s.done(),keys:[y.GK.d,y.GK.D,y.GK.a]};return i?i(r,s):r}}Be.ID=Ee,Be.MIN_X=Fe,Be.MAX_X=Te;const Se=-120,We=120,Ne=100,ze="d^a";function Ie(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Se,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:We,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ne;return s=>{const r=new W;e>0&&r.add(y.PB.MP,">=",e);const o={action_id:ze,desire:y.Tc.desire(n),status:[y.Sl.Chasing],e_ray:[{x:1,z:0,min_x:t,max_x:a,max_d:(0,g.n7)(i,2)}],expression:e>0?r.done():void 0,keys:[y.GK.d,y.GK.U,y.GK.a]};return s?s(o,r):o}}Ie.ID=ze,Ie.MIN_X=Se,Ie.MAX_X=We,Ie.Z_LEN=Ne;const De=-120,je=120,He=100,Ge="d^j";function $e(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:De,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:je,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:He;return s=>{const r=new W;e>0&&r.add(y.PB.MP,">=",e);const o={action_id:Ge,desire:y.Tc.desire(n),status:[y.Sl.Chasing],e_ray:[{x:1,z:0,min_x:t,max_x:a,max_d:(0,g.n7)(i,2)}],expression:e>0?r.done():void 0,keys:[y.GK.d,y.GK.U,y.GK.j]};return s?s(o,r):o}}function Xe(e){return e.base.strength=y.Tc.FIGHTER_STREAGTH_STRONG,e.base.group=(0,g.D8)(e.base.group,y.hG.Boss),e.base.mp_r_ratio=2,e.base.ce=2,v.make(e).set_actions(me(50,void 0),$e(250,void 0,-500,500,500),function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le;for(var t=arguments.length,a=new Array(t>2?t-2:0),i=2;i<t;i++)a[i-2]=arguments[i];return t=>{const i=new W,s={action_id:e,desire:y.Tc.desire(n),status:[y.Sl.Chasing],e_ray:[{x:1,z:0,reverse:!0}],keys:a.length?a:[y.GK.j]};return t?t(s,i):s}}("cancel_d>j"),Ie(100,void 0,-700,700,500),we("d^a+a",["a"],void 0,(0,be.E)(2,.1))).set_states([y.Fb.Attacking],["cancel_d>j","d^a+a"]).set_frames([...ye.standings,...ye.walkings],[me.ID,Ie.ID,$e.ID]),e}function Re(e,n){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:le;return i=>{const s=new W;t>0&&s.add(y.PB.MP,">=",t);const r={action_id:e,desire:y.Tc.desire(a),status:[y.Sl.Idle],expression:t>0?s.done():void 0,keys:n};return i?i(r,s):r}}$e.ID=Ge,$e.MIN_X=De,$e.MAX_X=je,$e.Z_LEN=He;const Ke=-10,Le=120,Me="d^j";function Oe(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:le,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ke,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Le;const i=(new W).add(y.PB.MP,">=",e);return{action_id:Me,desire:y.Tc.desire(n),status:[y.Sl.Chasing],e_ray:[{x:1,z:0,min_x:t,max_x:a}],expression:e>0?i.done():void 0,keys:[y.GK.d,y.GK.U,y.GK.j]}}function Ve(e){const n=Number(e.id);switch((n>=30&&n<=39||n>=50&&n<=59)&&(e.base.group=(0,g.D8)(e.base.group,y.hG.Hidden)),n>=1&&n<=29&&(e.base.group=(0,g.D8)(e.base.group,y.hG.Regular)),e.id){case y.PC.Julian:return function(e){e.base.strength=y.Tc.FIGHTER_STREAGTH_STRONG,e.base.group=(0,g.D8)(e.base.group,y.hG.Boss),e.base.mp_r_ratio=2,e.base.ce=3,e.base.armor={fireproof:1,antifreeze:1,hit_sounds:["data/002.wav.mp3"],type:y.T5.Fall,toughness:y.Tc.DEFAULT_FALL_VALUE_CRITICAL};for(const t in e.frames){var n;null===(n=e.frames[t].opoint)||void 0===n||n.forEach(e=>{e.oid===y.PC.Julian&&(e.hp=e.max_hp=20,e.mp=e.max_mp=150)})}return v.make(e).set_actions(ve("d>a",void 0,25,1/60),we("d>a+a",["a"],void 0,.15),me(125,void 0),$e(100,void 0,-120,120,100),Pe(0,void 0),{action_id:"injured_dja",desire:y.Tc.desire(.08),expression:(new W).add(y.PB.MP,">",25).done(),keys:[y.GK.d,y.GK.j,y.GK.a]},{action_id:"shaking_dja",desire:y.Tc.desire(.08),expression:(new W).add(y.PB.MP,">",25).and(y.PB.Shaking,">",0).done(),keys:[y.GK.d,y.GK.j,y.GK.a]}).set_frames([...ye.standings,...ye.walkings,...ye.runnings],["shaking_dja","d^a","d^j","d>j","d>a"]).set_frames([...ye.punchs],["d^a","shaking_dja"]).set_states([y.Fb.Attacking],["shaking_dja","d>a+a"]),e}(e);case y.PC.Firzen:return Xe(e);case y.PC.LouisEX:return function(e){return e.base.strength=y.Tc.FIGHTER_STREAGTH_STRONG,e.base.group=(0,g.D8)(e.base.group,y.hG.Boss),v.make(e).set_actions(pe(100,void 0,150,400),ke("d>a+a",.5,100),Be(0,void 0,-10,120)).set_frames([...ye.standings,...ye.walkings],["d>a","dva"]).set_frames([...ye.punchs],["dva"]).set_frames((0,g.BY)(260,269),["d>a+a"]).set_dataset({w_atk_f_x:90,w_atk_b_x:90,j_atk_f_x:90,j_atk_b_x:90}),e}(e);case y.PC.Bat:return function(e){return e.base.group=(0,g.D8)(e.base.group,y.hG.Boss),v.make(e).set_actions(pe(25,void 0),me(50,void 0,50,120),ve("d^j",void 0,200,.05),ve("dva",void 0)).set_states([y.Fb.Catching],["dva"]).set_frames([...ye.standings,...ye.walkings,...ye.runnings],["d^j","d>j","d>a"]),e}(e);case y.PC.Knight:return function(e){return e.base.strength=y.Tc.FIGHTER_STREAGTH_STRONG,e.base.armor={hit_sounds:["data/085.wav.mp3"],type:y.T5.Fall,toughness:y.Tc.DEFAULT_FALL_VALUE_CRITICAL},e}(e);case y.PC.Louis:return function(e){e.base.armor={hit_sounds:["data/085.wav.mp3"],type:y.T5.Defend,fulltime:!1,toughness:30};for(const t in e.frames){var n;const a=null===(n=e.frames[t].seqs)||void 0===n?void 0:n.ja;a&&"id"in a&&"300"===a.id&&(a.expression=(new W).add(y.PB.HP_P,"<=",33).or(y.PB.LF2_NET_ON,"==",1).done())}return v.make(e).set_actions(pe(150,void 0,120,400),me(50,void 0,120,250),Oe(100,void 0,-10,120),ve("dja",void 0,void 0,.01)((e,n)=>(e.expression=null===n||void 0===n?void 0:n.and(y.PB.HP_P,"<",33).done(),e))).set_frames([...ye.standings,...ye.walkings],["d^j","d>a","d>j","dja"]).set_frames([...ye.punchs],["d^j"]),e}(e);case y.PC.Rudolf:return function(e){for(const t in e.frames){var n;null===(n=e.frames[t].opoint)||void 0===n||n.forEach(e=>{e.oid===y.PC.Rudolf&&(e.hp=e.max_hp=20,e.mp=e.max_mp=150)})}return v.make(e).set_dataset({w_atk_m_x:50,w_atk_b_x:300,w_atk_f_x:300,r_desire_max:2*y.Tc.AI_R_DESIRE_MAX,r_desire_min:2*y.Tc.AI_R_DESIRE_MIN}).set_actions(pe(100,void 0,120,300)((e,n)=>(e.action_id="d>a_1",e.e_ray[0].max_d=4e4,e)),pe(100,void 0,300,500)((e,n)=>(e.action_id="d>a_2",e.e_ray[0].max_d=16e4,e)),me(0,void 0,79,120)).set_frames([...ye.standings,...ye.walkings],["d>a_1","d>a_2","d>j"]),e}(e);case y.PC.Deep:return function(e){return e.base.strength=y.Tc.FIGHTER_STREAGTH_STRONG,v.make(e).set_actions(pe(75,void 0,50,200),ke("d>a+a",.5,75),me(150,void 0,50,200)((e,n)=>(e.expression=n.and(y.N0.EnemyOutOfRange,"!=",1).done(),e)),ve("d>j","catching_d>j",150),Be(75,void 0,Be.MIN_X,Be.MAX_X),Be(75,1,Be.MIN_X,Be.MAX_X)((e,n)=>(e.action_id="dva+a",e.expression=n.and(y.N0.EnemyY,"<=",0).done(),e.keys=[y.kG.a],e)),Be(150,(0,be.E)(4,.5),.5,Be.MAX_X)((e,n)=>(e.action_id="dva+j",e.keys=[y.kG.j],e.expression=n.and(y.N0.EnemyY,">",0).done(),e)),Be(0,void 0,Be.MAX_X,Be.MIN_X+Be.MAX_X)(e=>(e.action_id="d^j",e.keys=[y.kG.d,y.kG.U,y.kG.j],e)),Be(150,1,Be.MIN_X,Be.MAX_X)(e=>(e.action_id="d^j+a",e.keys=[y.kG.a],e))).set_states([y.Fb.Rowing],[me.ID]).set_states([y.Fb.Catching],["catching_d>j"]).set_frames([...ye.standings,...ye.walkings,...ye.runnings],["d^j",me.ID,pe.ID,Be.ID]).set_frames([...ye.punchs],[Be.ID]).set_frames((0,g.BY)(235,250),["d>a+a"]).set_frames([...(0,g.BY)(260,265),...(0,g.BY)(277,282)],["dva+a","dva+j"]).set_frames((0,g.BY)(266,267),["d^j+a"]),e}(e);case y.PC.Davis:return function(e){return v.make(e).set_actions(pe(50,void 0,50),ke("d>a+a",(0,be.E)(3,.8),50),Pe(225,void 0,Pe.MIN_X,Pe.MAX_X),Be(75,void 0,Be.MIN_X,Be.MAX_X),Be(25,(0,be.E)(5,.5),Be.MIN_X,Be.MAX_X)((e,n)=>(e.action_id="dva+j",e.keys=[y.kG.j],e.expression=n.and(y.N0.EnemyY,">",0).done(),e)),Be(25,void 0,Be.MAX_X,Be.MIN_X+Be.MAX_X)(e=>(e.action_id="d^j",e.keys=[y.kG.d,y.kG.U,y.kG.j],e)),Be(0,1,Be.MIN_X,40)(e=>(e.action_id="d^j+a",e.keys=[y.kG.a],e)),we("dva+run",["F","F"],0,(0,be.E)(7,.5))).set_states([y.Fb.Rowing],["d^a","d^j"]).set_states([y.Fb.Catching],["d^a","dva"]).set_frames([...ye.standings,...ye.walkings,...ye.runnings],["d^a","d^j","d>a","dva"]).set_frames(ye.punchs,["dva","d^a"]).set_frames((0,g.BY)(240,269),["d>a+a"]).set_frames([282],["dva+run"]).set_frames([...(0,g.BY)(270,289,1)],["dva+j","d^a"]).set_frames([39],["dva+j","d^a"]).set_frames((0,g.BY)(290,292),["d^j+a"]),e}(e);case y.PC.Dennis:return function(e){return v.make(e).set_actions(pe(40,void 0,50),ke("d>a+a",.8,40),Be(75,1/60,Be.MIN_X,Be.MAX_X),me(75,1/60,50,300)((e,n)=>{var t;return null===(t=e.e_ray)||void 0===t||t.push({...e.e_ray[0],z:.3},{...e.e_ray[0],z:-.3}),e.expression=n.and(y.N0.EnemyOutOfRange,"!=",1).done(),e}),Be(75,(0,be.E)(6,.2),Be.MIN_X,Be.MAX_X)(e=>(e.action_id="run_atk+dva",e)),me(75,(0,be.E)(6,.2),10,100)(e=>{var n;return e.action_id="run_atk+d>j",null===(n=e.e_ray)||void 0===n||n.push({...e.e_ray[0],z:.3},{...e.e_ray[0],z:-.3}),e}),me(0,void 0,0,1e3)((e,n)=>{var t;e.action_id="cancel_d>j";const a=e.e_ray[0];return a.reverse=!0,null===(t=e.e_ray)||void 0===t||t.push({...a,z:.2},{...a,z:-.2}),e.expression=n.or(y.N0.EnemyDiffX,"<",-100).done(),e.keys=[y.kG.Jump],e}),Ie(100,1/60,Ie.MAX_X,2e3,1e3),ve("d>j","catching_d>j",75),ve("dva","catching_dva",75)).set_states([y.Fb.Catching],["catching_d>j","catching_dva","d^a"]).set_frames([...ye.standings,...ye.walkings],["d>a","d^a","dva","d>j"]).set_frames([...ye.punchs],["dva","d>j"]).set_frames([88,89],["run_atk+dva","run_atk+d>j"]).set_frames((0,g.BY)(235,262),["d>a+a"]).set_frames((0,g.BY)(280,290),["cancel_d>j"]),e}(e);case y.PC.Woody:return function(e){return v.make(e).set_actions(pe(125,void 0,50)(e=>{var n;const t=e.e_ray[0];return t.z=.1,null===(n=e.e_ray)||void 0===n||n.push({...t,z:-t.z}),e}),me(200,void 0,50,200)((e,n)=>{var t;const a=e.e_ray[0];return null===(t=e.e_ray)||void 0===t||t.push({...a,z:.2},{...a,z:-.2}),e.expression=n.and(y.N0.EnemyOutOfRange,"!=",1).done(),e}),me(200,.3,50,200)((e,n)=>{var t;e.action_id="c_d>j";const a=e.e_ray[0];return null===(t=e.e_ray)||void 0===t||t.push({...a,z:.2},{...a,z:-.2}),e.expression=n.and(y.N0.EnemyOutOfRange,"!=",1).done(),e}),Pe(0,void 0,Pe.MIN_X,Pe.MAX_X),ve("d^j",void 0,50,.01)((e,n)=>(e.expression=n.and(y.N0.EnemyOutOfRange,"!=",1).done(),e)),ve("dvj",void 0,50,.01),ve("d^a","catching_d^a",0),Be(0,void 0,80,Pe.MAX_X)).set_states([y.Fb.Catching],["catching_d^a"]).set_frames([...ye.standings,...ye.walkings],["d>a","d^a","dva","d>j","d^j","dvj"]).set_states([y.Fb.Jump],["d^j","dvj"]).set_frames([...ye.rowings],["dva"]).set_frames([286,287,288,301,302,303,271],["c_d>j","d^a"]).set_frames([215,219],["c_d>j","d^a"]),e}(e);case y.PC.Firen:return function(e){return[e.frames.running_0,e.frames.running_1,e.frames.running_2,e.frames.running_3].filter(Boolean).map(e=>{e.itr=(0,g.D8)(e.itr,{hit_flag:y._0.Fighter|y._0.Ally,code:123,kind:y.w7.Normal,effect:y.pd.Ignore,z:-y.Tc.DAFUALT_QUBE_LENGTH/2,l:y.Tc.DAFUALT_QUBE_LENGTH,x:35,y:19,w:10,h:60,test:(new W).add(w.W.BdyCode,"==",123).and(w.W.BdyHitFlag,"==",y._0.Fighter|y._0.Ally).and(w.W.SameFacing,"==",0).done()})}),v.make(e).set_actions(pe(75,void 0,50),ke("d>a+a",.8,75),me(75,void 0,50,1e3)((e,n)=>{var t;return null===(t=e.e_ray)||void 0===t||t.push({...e.e_ray[0],z:.2},{...e.e_ray[0],z:-.2}),e.expression=n.and(y.N0.EnemyOutOfRange,"!=",1).done(),e}),me(0,void 0,0,1e3)((e,n)=>{var t;e.action_id="cancel_d>j";const a=e.e_ray[0];return a.reverse=!0,null===(t=e.e_ray)||void 0===t||t.push({...a,z:.2},{...a,z:-.2}),e.expression=n.or(y.N0.EnemyDiffX,"<",-100).done(),e.keys=[y.kG.Jump],e}),me(75,void 0,50,200)(e=>{var n;return e.action_id="dvj",null===(n=e.e_ray)||void 0===n||n.push({...e.e_ray[0],z:.05},{...e.e_ray[0],z:-.1}),e.keys=[y.kG.Defend,y.kG.Down,y.kG.Jump],e}),me(0,void 0,50,200)(e=>{var n;e.action_id="cancel_dvj";const t=e.e_ray[0];return t.reverse=!0,null===(n=e.e_ray)||void 0===n||n.push({...t,z:.05},{...t,z:-.05}),e.keys=[y.kG.Jump],e}),$e(300,1/60,-110,110,900)).set_frames([...ye.standings,...ye.walkings],["d>a","d>j","d^j","dvj"]).set_frames((0,g.BY)(255,261),["cancel_d>j"]).set_frames((0,g.BY)(267,275),["cancel_dvj"]).set_frames((0,g.BY)(235,252),["d>a+a"]),e}(e);case y.PC.Freeze:return function(e){return[e.frames.running_0,e.frames.running_1,e.frames.running_2,e.frames.running_3].filter(Boolean).map(e=>{e.bdy=(0,g.D8)(e.bdy,{hit_flag:y._0.Fighter|y._0.Ally,code:123,kind:y.aW.Normal,z:-y.Tc.DAFUALT_QUBE_LENGTH/2,l:y.Tc.DAFUALT_QUBE_LENGTH,x:35,y:19,w:10,h:60,actions:[{type:b.X.FUSION,data:{oid:y.PC.Firzen,act:{id:"290"},time:9e3}}],test:(new W).add(w.C.ItrCode,"==",123).and(w.C.ItrHitFlag,"==",y._0.Fighter|y._0.Ally).and(w.C.SameFacing,"==",0).and(e=>e.add(w.C.V_HP_P,"<=",33).and(w.C.A_HP_P,"<",33).or(w.C.LF2_NET_ON,"==",1)).done()})}),v.make(e).set_actions(pe(100,void 0,50)(e=>{var n;return null===(n=e.e_ray)||void 0===n||n.push({...e.e_ray[0],z:.3},{...e.e_ray[0],z:-.3}),e}),me(150,void 0,50,300)(e=>{var n;return null===(n=e.e_ray)||void 0===n||n.push({...e.e_ray[0],z:.2},{...e.e_ray[0],z:-.2}),e}),ve("dvj",void 0,150,1/180)((e,n)=>(e.expression=n.and(y.PB.Holding,"==",0).done(),e)),$e(300,void 0,-110,150,1600)).set_frames([...ye.standings,...ye.walkings],["d>a","d>j","d^j","wa"]),e}(e);case y.PC.Jack:return function(e){return v.make(e).set_actions(pe(40,void 0,50),ke("d>a+d>a",(0,be.E)(3,.3),40,y.GK.d,"F",y.GK.a),Pe(225,1/15,Pe.MIN_X,Pe.MAX_X)).set_states([y.Fb.Rowing,y.Fb.Catching],["d^a"]).set_frames([...ye.standings,...ye.walkings],["d^a","d>a"]).set_frames(ye.punchs,["d^a"]).set_frames((0,g.BY)(240,247),["d>a+d>a"]),e}(e);case y.PC.Mark:return function(e){return e.base.strength=y.Tc.FIGHTER_STREAGTH_STRONG,v.make(e).set_actions(pe(0,void 0,0,80,.1)(e=>((0,T.X)(e.e_ray,e=>e.max_d=1600),e)),we("d>a+a",[y.GK.a],0,1/15),me(50,void 0,20,200,.1)((e,n)=>((0,T.X)(e.e_ray,e=>e.max_d=1600),e.expression=n.and(y.N0.EnemyOutOfRange,"!=",1).done(),e)),me(0,void 0,0,1e3)((e,n)=>{var t;e.action_id="cancel_d>j";const a=e.e_ray[0];return a.reverse=!0,null===(t=e.e_ray)||void 0===t||t.push({...a,z:.2},{...a,z:-.2}),e.expression=n.or(y.N0.EnemyDiffX,"<",-100).done(),e.keys=[y.GK.Jump],e})).set_frames([...ye.standings,...ye.walkings],["d>j","d>a"]).set_frames(ye.punchs,["d>j","d>a"]).set_frames((0,g.BY)(240,244),["cancel_d>j"]).set_frames((0,g.BY)(85,89),["d>a+a"]),e}(e);case y.PC.Monk:return function(e){return v.make(e).set_actions(pe(100,1/15,0,400),pe(100,.5,0,400)(e=>(e.keys=[y.GK.Defend,"F",y.GK.Attack],e))).set_frames([...ye.standings,...ye.walkings],["d>a"]).set_frames(ye.punchs,["d>a"]).set_frames((0,g.BY)(240,248),["d>a+d>a"]),e}(e);case y.PC.Henry:return function(e){return v.make(e).set_dataset({w_atk_m_x:100,w_atk_b_x:350,w_atk_f_x:350}).set_actions(pe(150,void 0,120,400),me(200,void 0,120,1e3,.3),me(150,void 0,120,300)((e,n)=>(e.action_id="dja_1",e.keys=[y.GK.d,y.GK.j,y.GK.a],e.e_ray[0].max_d=4e4,e)),me(150,void 0,300,500)((e,n)=>(e.action_id="dja_2",e.keys=[y.GK.d,y.GK.j,y.GK.a],e.e_ray[0].max_d=16e4,e)),$e(350,void 0,-250,250,9e4)).set_frames([...ye.standings,...ye.walkings],["d>a","d>j","dja_1","dja_2","d^j"]),e}(e);case y.PC.Hunter:return function(e){return e.base.group=(0,g.D8)(e.base.group,y.hG._3000),v.make(e).set_dataset({w_atk_m_x:100,w_atk_b_x:200,w_atk_f_x:200}),e}(e);case y.PC.Justin:return function(e){return v.make(e).set_actions(pe(75,void 0,50,200),_e("dva",[y.GK.d,y.GK.D,y.GK.a],75,void 0,-10,100),we("d>a+a",[y.GK.a],75,void 0)).set_frames([...ye.standings,...ye.walkings],["dva","d>a"]).set_frames(ye.punchs,["dva"]).set_frames((0,g.BY)(240,246),["d>a+a"]),e}(e);case y.PC.Jan:return function(e){return e.base.strength=y.Tc.FIGHTER_STREAGTH_WEAK,e.base.files[0].variants=["2"],e.base.files[1].variants=["3"],v.make(e).set_actions(Ie(150,void 0,50,400,16e4),$e(200,void 0,0,1e4)((e,n)=>e)).set_frames([...ye.standings,...ye.walkings],["d^a","d^j"]),e}(e);case y.PC.Sorcerer:return function(e){return v.make(e).set_actions(pe(75,void 0,100,1e4),me(125,void 0,100,1e4),Re("dvj",[y.GK.Defend,y.GK.Down,y.GK.Jump],350)((e,n)=>(e.status=[y.Sl.Idle,y.Sl.Chasing,y.Sl.Avoiding],e.expression=n.and(y.PB.HpRecoverable,">=",50).and(y.N0.Safe,"==",1).done(),e)),Re("d^j",[y.GK.Defend,y.GK.Up,y.GK.Jump],350)((e,n)=>(e.status=[y.Sl.Idle,y.Sl.Chasing,y.Sl.Avoiding],e.expression=n.and(y.PB.HpRecoverable,">=",50).and(y.N0.Safe,"==",1).done(),e))).set_frames([...ye.standings,...ye.walkings],["d>a","d>j","d^j","dvj"]),e}(e);case y.PC.John:return function(e){return v.make(e).set_actions(pe(75,void 0,100,1e4),me(100,void 0,100,1e4),we("d^a",[y.GK.Defend,y.GK.Up,y.GK.Attack],250),Re("dvj",[y.GK.Defend,y.GK.Down,y.GK.Jump],350)((e,n)=>(e.status=[y.Sl.Idle,y.Sl.Chasing,y.Sl.Avoiding],e.expression=n.and(y.PB.HpRecoverable,">=",100).and(y.N0.Safe,"==",1).done(),e)),Re("d^j",[y.GK.Defend,y.GK.Up,y.GK.Jump],350)((e,n)=>(e.status=[y.Sl.Idle,y.Sl.Chasing,y.Sl.Avoiding],e.expression=n.and(y.PB.HpRecoverable,">=",100).and(y.N0.Safe,"==",1).done(),e)),we("s_punch+j",[y.GK.Jump])((e,n)=>(e.expression=n.and(y.N0.EnemyState,"==",y.Fb.Falling).done(),e)),we("s_punch+d>a",[y.GK.Defend,"F",y.GK.Attack],100)((e,n)=>(e.expression=n.and(y.N0.EnemyState,"==",y.Fb.Falling).done(),e)),we("s_punch+d>j",[y.GK.Defend,"F",y.GK.Jump],100)((e,n)=>(e.expression=n.and(y.N0.EnemyState,"==",y.Fb.BrokenDefend).done(),e))).set_frames([...ye.standings,...ye.walkings],["d>a","d>j","d^a","d^j","dvj"]).set_frames(ye.super_punch,["s_punch+j","s_punch+d>a","s_punch+d>j"]),e}(e);case y.PC.Template:break;case y.PC.Bandit:e.base.group=(0,g.D8)(e.base.group,y.hG._3000);case y.PC.Weapon0:case y.PC.Weapon2:case y.PC.Weapon4:case y.PC.Weapon5:case y.PC.Weapon6:case y.PC.Weapon1:case y.PC.Weapon3:case y.PC.Weapon8:case y.PC.Weapon9:case y.PC.Weapon10:case y.PC.Weapon11:case y.PC.Criminal:case y.PC.JohnBall:case y.PC.HenryArrow1:case y.PC.RudolfWeapon:case y.PC.DeepBall:case y.PC.HenryWind:case y.PC.DennisBall:case y.PC.WoodyBall:case y.PC.DavisBall:case y.PC.HenryArrow2:case y.PC.FreezeBall:case y.PC.FirenBall:case y.PC.FirenFlame:case y.PC.FreezeColumn:case y.PC.Weapon7:case y.PC.JohnBiscuit:case y.PC.DennisChase:case y.PC.JackBall:case y.PC.JanChaseh:case y.PC.JanChase:case y.PC.FirzenChasef:case y.PC.FirzenChasei:case y.PC.FirzenBall:case y.PC.BatBall:case y.PC.BatChase:case y.PC.JustinBall:case y.PC.JulianBall:case y.PC.JulianBall2:case y.PC.Etc:case y.PC.BrokenWeapon:}return e}function Je(e,n,t){const{blocks:a,remains:i}=V(e,n,t);return{sections:a.map(e=>{const n={};for(const[a,i]of f(e)){var t;n[a]=null!==(t=B(i))&&void 0!==t?t:i}return n}),remains:i}}Oe.ID=Me,Oe.MIN_X=Ke,Oe.MAX_X=Le;var Ue=t(8258),Ye=t(5248);function qe(e,n){if(!e)return;e.hit_flag=k._0.AllEnemy,e.l=M.T.DAFUALT_QUBE_LENGTH,e.z=-M.T.DAFUALT_QUBE_LENGTH/2;const t=Number((0,X.$)(e,"kind"));e.kind=t,e.kind_name=(0,Q.tB)(e.kind),e.kind===Q.rs.Normal&&n.state===y.Fb.Caught&&(e.hit_flag=k._0.AllBoth),(0,g.Tq)(e.kind,Q.IL,Q.oG)&&(e.kind=Q.rs.Criminal,e.kind_name=(0,Q.tB)(e.kind),e.test=(new W).add(e=>e.add(w.W.SameTeam,"==",0).and(w.W.AttackerType,"==",l.gB.Fighter).and(w.W.ItrKind,"==",z.g2.Normal)).or(e=>e.add(w.W.SameTeam,"==",0).and(w.W.AttackerType,"==",l.gB.Weapon).and(e=>e.add(w.W.ItrKind,"==",z.g2.WeaponSwing).or(w.W.AttackerOID,"==",Ue.g.HenryArrow1).or(w.W.AttackerOID,"==",Ue.g.RudolfWeapon))).done(),e.actions=(0,g.D8)(e.actions,{type:b.X.V_NextFrame,data:{id:""+(t-1e3)}},{type:b.X.V_TURN_TEAM,data:""})),(0,g.tH)(e,Ye.C)}function Ze(e,n){}var Qe=t(5240);function en(e,n,t){const a=Number((0,X.$)(e,n));if((0,g.gO)(a)&&-842150451!==a)return t?t(a):a}function nn(e,n){e.throwvx=en(e,"throwvx",e=>.5*e),e.throwvy=en(e,"throwvy",e=>-.5*e),e.throwvz=en(e,"throwvz",e=>1*e),e.throwinjury=en(e,"throwinjury",e=>1*e),e.decrease=function(e,n,t){const a=Number((0,X.$)(e,n));if((0,g.AK)(a)&&-842150451!==a)return t?t(a):a}(e,"decrease",e=>-(0,g.tn)(e)),e.z=0;const t=en(e,"cover",e=>e);11==t&&(e.z=2),10==t&&(e.z=-2);const a=(0,X.$)(e,"vaction"),i=(0,X.$)(e,"injury");var s;((0,E.AK)(i)&&(e.injury=(0,g.tn)(i),i>0&&(e.shaking=M.T.DEFAULT_ITR_SHAKING)),(0,S.Hl)(a)||(0,E.AK)(a))&&(e.vaction=$(a),11!==t&&10!==t||(e.vaction.facing=Qe.p.SameAsCatcher),e.throwvx&&(null===(s=e.vaction)||void 0===s||delete s.facing));e.throwvx&&-1!=e.throwinjury&&(e.tx=e.throwvx<0?0:80,e.ty=10)}function tn(e,n){return Number(e.toFixed(1))}function an(e,n,t){const a=Number((0,X.$)(e,n));return(0,g.v$)(a)?t?t(a):a:void 0}function sn(e,n){var t;if(!e)return;e.hit_flag=k._0.AllEnemy,e.vrest=an(e,"vrest",e=>(0,g.T9)(2,2*e-M.T.DEFAULT_ITR_SHAKING-4)),e.arest=an(e,"arest",e=>(0,g.T9)(2,2*e-M.T.DEFAULT_ITR_MOTIONLESS-4));const a=e.dvx;e.dvx=en(e,"dvx",e=>tn(.5*e)),e.dvz=en(e,"dvz",e=>tn(.5*e)),e.dvy=en(e,"dvy",e=>tn(-.59*e)),e.fall=en(e,"fall",e=>2*e),e.bdefend=en(e,"bdefend",e=>2*e);const i=null!==(t=en(e,"zwidth"))&&void 0!==t?t:M.T.DAFUALT_QUBE_LENGTH/2;e.l=2*i,e.z=-i;const s=y.w7[e.kind];if(s&&(e.kind_name=`ItrKind.${s}`),void 0!==e.effect){const n=y.pd[e.effect];n&&(e.effect_name=`ItrEffect.${n}`)}switch(e.kind){case y.w7.Normal:{const n=new W;switch(e.effect){case y.pd.Fire:n.and(e=>e.add(w.W.VictimState,"!=",y.Fb.Burning).or(w.W.AttackerState,"!=",y.Fb.BurnRun));break;case y.pd.MFire1:n.and(w.W.VictimType,"!=",l.D2.Fighter).or(e=>e.add(w.W.VictimState,"!=",y.Fb.BurnRun).and(w.W.VictimState,"!=",y.Fb.Burning));break;case y.pd.MFire2:n.and(e=>e.add(w.W.VictimState,"!=",y.Fb.BurnRun).and(w.W.VictimState,"!=",y.Fb.Burning));break;case y.pd.Through:n.and(w.W.VictimType,"!=",l.D2.Fighter);break;case y.pd.Ice2:n.and(e=>e.add(w.W.VictimState,"!=",y.Fb.Frozen).and(w.W.VictimFrameId,"!=",w.W.VictimFrameIndex_ICE))}e.test=n.done()||void 0;break}case y.w7.Pick:e.hit_flag=k._0.AllBoth,e.motionless=0,e.shaking=0,e.test=(new W).add(w.W.AttackerHasHolder,"==",0).and(w.W.VictimHasHolder,"==",0).and().one_of(w.W.VictimState,y.Fb.Weapon_OnGround,y.Fb.HeavyWeapon_OnGround).done();break;case y.w7.PickSecretly:e.hit_flag=k._0.AllBoth,e.motionless=0,e.shaking=0,e.test=(new W).add(w.W.AttackerHasHolder,"==",0).and(w.W.VictimHasHolder,"==",0).and(w.W.VictimState,"==",y.Fb.Weapon_OnGround).done();break;case y.w7.SuperPunchMe:e.motionless=0,e.shaking=0,e.test=(new W).add(w.W.VictimType,"==",l.D2.Fighter).done();break;case y.w7.MagicFlute:case y.w7.MagicFlute2:return e.motionless=0,e.shaking=0,void(e.test=(new W).add(w.W.VictimType,"==",l.D2.Fighter).or(e=>e.add(w.W.VictimType,"==",l.D2.Weapon).and(w.W.VictimOID,"!=",y.PC.HenryArrow1).and(w.W.VictimOID,"!=",y.PC.RudolfWeapon)).done());case y.w7.ForceCatch:e.motionless=0,e.shaking=0,e.vrest&&(e.arest=e.vrest,delete e.vrest),e.test=(new W).and(w.W.VictimType,"==",l.D2.Fighter).and(w.W.VictimState,"!=",y.Fb.Falling).done();break;case y.w7.Catch:e.motionless=0,e.shaking=0,e.vrest&&(e.arest=e.vrest,delete e.vrest),e.test=(new W).and(w.W.VictimType,"==",l.D2.Fighter).and(w.W.VictimState,"==",y.Fb.Tired).done();break;case y.w7.Block:e.hit_flag=k._0.AllBoth,e.motionless=0,e.shaking=0,e.test=(new W).add(w.W.BdyKind,"==",Q.aW.Normal).done();break;case y.w7.JohnShield:e.hit_flag=k._0.AllBoth,e.test=(new W).and(w.W.VictimType,"!=",l.D2.Fighter).or(w.W.SameTeam,"!=",1).done();break;case y.w7.Heal:e.hit_flag=k._0.AllBoth,a&&(e.actions=(0,g.D8)(e.actions,{type:b.X.A_NextFrame,data:$(a)})),e.test=(new W).and(w.W.VictimType,"==",l.D2.Fighter).done();break;case y.w7.Freeze:e.hit_flag=k._0.AllBoth,e.shaking=0,e.motionless=0,e.dvx=0,e.dvy=0,e.dvz=0,e.test=(new W).add(w.W.VictimType,"==",l.D2.Fighter).and(e=>e.add(w.W.SameTeam,"==",0).or(w.W.VictimState,"==",y.Fb.Frozen)).done();break;case y.w7.Whirlwind:e.hit_flag=k._0.AllBoth,e.shaking=0,e.motionless=0,e.vrest=1,e.injury=void 0,e.dvx=0,e.dvy=0,e.dvz=0,e.test=(new W).wrap(e=>e.add(w.W.VictimType,"==",l.D2.Weapon).and(w.W.VictimOID,"!=",y.PC.HenryArrow1).and(w.W.VictimOID,"!=",y.PC.Rudolf)).or(e=>e.add(w.W.VictimType,"==",l.D2.Fighter).and(e=>e.add(w.W.SameTeam,"==",0).or(w.W.VictimState,"==",y.Fb.Frozen))).done();break;case y.w7.CharacterThrew:e.hit_flag=k._0.AllBoth,e.test=(new W).add(w.W.AttackerThrew,"==",1).and(w.W.AttackerType,"==",l.D2.Fighter).done()}const r=(0,X.$)(e,"catchingact");(0,E.AK)(r)&&(e.catchingact=$(r));const o=(0,X.$)(e,"caughtact");(0,E.AK)(o)&&(e.caughtact={...$(o),facing:y.pg.OpposingCatcher})}function rn(e,n){const t=(0,X.$)(e,"action");if(e.oid=""+(0,X.$)(e,"oid"),(0,E.AK)(t)){const n=$(t),a=(0,X.$)(e,"facing");(0,E.AK)(a)?(n.facing=a%2?y.pg.Backward:y.pg.None,a>=2&&a<=19?n.facing=y.pg.Right:a>=20&&(e.multi=(0,O.RI)(a/10))):n.facing=y.pg.None,e.action=n}const a=(0,X.$)(e,"dvx");(0,E.gO)(a)?e.dvx=.5*a:e.dvx=0;const i=(0,X.$)(e,"dvz");(0,E.gO)(i)&&(e.dvz=.5*i);const s=(0,X.$)(e,"dvy");(0,E.gO)(s)&&(e.dvy=-.5*s)}function on(e,n){const t=(0,X.$)(e,"dvx");(0,E.gO)(t)&&(e.dvx=.5*t);const a=(0,X.$)(e,"dvz");(0,E.gO)(a)&&(e.dvz=a);const i=(0,X.$)(e,"dvy");(0,E.gO)(i)&&(e.dvy=-.5*i);const s=(0,X.$)(e,"attacking");s&&(e.attacking=""+s),e.z=0;const r=en(e,"cover",e=>e);1==r&&(e.z=-2),0==r&&(e.z=2)}function dn(e){switch(e.state){case y.Fb.Ball_3005:e.no_shadow=1;break;case y.Fb.HeavyWeapon_OnHand:case y.Fb.Weapon_OnHand:e.no_shadow=1,e.gravity_enabled=!1;break;case y.Fb.Burning:(0,T.X)(e.itr,e=>{e.hit_flag=k._0.AllBoth});break;case y.Fb.OLD_LouisCastOff:e.state=y.Fb.Attacking,e.opoint=(0,g.D8)(e.opoint,{kind:y.EC.Normal,x:39,y:79,oid:"218",dvy:5,action:{id:"auto"},speedz:0},{kind:y.EC.Normal,x:39,y:79,oid:"217",dvy:4,dvx:-5,dvz:4,action:{id:"auto",facing:y.pg.Backward},speedz:0},{kind:y.EC.Normal,x:39,y:79,oid:"217",dvy:4,dvx:-5,dvz:-4,action:{id:"auto",facing:y.pg.Backward},speedz:0},{kind:y.EC.Normal,x:39,y:79,oid:"217",dvy:4,dvx:-5,dvz:4,action:{id:"auto"},speedz:0},{kind:y.EC.Normal,x:39,y:79,oid:"217",dvy:4,dvx:-5,dvz:-4,action:{id:"auto"},speedz:0});break;case y.Fb.Falling:(0,T.X)(e.bdy,e=>{e.kind===y.aW.Normal&&(e.test=(new W).add(w.W.ItrFall,">=",y.Tc.DEFAULT_FALL_VALUE_CRITICAL).or(w.W.ItrKind,"==",y.w7.MagicFlute).or(w.W.ItrKind,"==",y.w7.MagicFlute2).done())});break;case y.Fb.Frozen:(0,T.X)(e.bdy,e=>e.hit_flag=k._0.AllBoth);break;case y.Fb.Message:e.no_shadow=1}}function cn(e,n){const t={},a=/<frame>\s+(.*?)\s+(.*)((.|\n)+?)<frame_end>/g;for(const[,d,c,l]of u(e,a)){var i,s,r;let e=l;const a=Je(e,"bdy:","bdy_end:"),_=a.sections;e=a.remains;const h=Je(e,"itr:","itr_end:"),u=h.sections;e=h.remains;const p=Je(e,"opoint:","opoint_end:"),g=p.sections;e=p.remains;const m=Je(e,"wpoint:","wpoint_end:"),v=m.sections;e=m.remains;const b=Je(e,"bpoint:","bpoint_end:"),k=b.sections;e=b.remains;const w=Je(e,"cpoint:","cpoint_end:"),C=w.sections;e=w.remains;const x={};for(const[n,t]of f(e)){var o;x[n]=null!==(o=B(t))&&void 0!==o?o:t}const A=(0,X.$)(x,"next"),P=$(A),T=(0,X.$)(x,"pic");let S,W,N,z=T;for(const t in n){const{row:e,col:a}=W=n[t];if(z<e*a)break;z-=e*a}if(W){const{id:e,row:n,cell_w:t,cell_h:a}=W;S={tex:e,x:(t+1)*(z%n),y:(a+1)*(0,O.RI)(z/n),w:t,h:a}}else N={msg:"entity_pic_info not found!",files:n,pic_idx:T};const I={id:d,name:c,pic:S,wait:2*(0,X.$)(x,"wait")+1,next:P,...x};for(const n of _)qe(n,I);for(const n of u)sn(n);for(const n of k)Ze();for(const n of g)rn(n);for(const n of v)on(n);for(const n of C)nn(n);u.length&&(I.itr=u),_.length&&(I.bdy=_),g.length&&(I.opoint=g),v.length&&(I.wpoint=v[0]),C.length&&(I.cpoint=C[0]),k.length&&(I.bpoint=k[0]);const D=y.Fb[I.state];D&&(I.state_name=`StateEnum.${D}`),N&&(I.__ERROR__=N),(A>=1100&&A<=1299||A<=-1100&&A>=-1299)&&(I.invisible=2*((0,O.tn)(A)-1100)),null!==(i=I.itr)&&void 0!==i&&i.length||delete I.itr,null!==(s=I.bdy)&&void 0!==s&&s.length||delete I.bdy,null!==(r=I.opoint)&&void 0!==r&&r.length||delete I.opoint,I.wpoint||delete I.wpoint,I.bpoint||delete I.bpoint,I.cpoint||delete I.cpoint;const j=(0,X.$)(I,"sound");j&&(I.sound=j.replace(/\\/g,"/")+".mp3"),t[d]=I;new ae(I).init(I);const H=(0,X.$)(C[0],"dircontrol");H&&(I.hit=I.hit||{},1===H?I.hit.B=te(I.hit.B,{wait:"i",facing:y.pg.Backward}):I.hit.F=te(I.hit.F,{wait:"i",facing:y.pg.Backward}));const G=(0,X.$)(I,"dvx");550===G?(I.dvx=0,I.vxm=F.h.Fixed,I.ctrl_x=0):(0,E.gO)(G)&&(G>=501&&G<=549||G>=551?(I.dvx=Number((.5*(G-550)).toFixed(1)),I.vxm=F.h.FixedLf2):I.dvx=Number((.5*G).toFixed(1)));const R=(0,X.$)(I,"dvy");550===R?(I.dvy=0,I.vym=F.h.Fixed,I.gravity_enabled=!1,I.ctrl_y=0):(0,E.gO)(R)&&(R>=501&&R<=549||R>=551?(I.dvy=-.285*(R-550),I.vym=F.h.FixedLf2):I.dvy=-.285*R);const K=(0,X.$)(I,"dvz");if(550===K?(I.dvz=0,I.vzm=F.h.Fixed,I.ctrl_z=0):(0,E.gO)(K)&&(K>=501&&K<=549||K>=551?(I.dvz=K-550,I.vzm=F.h.FixedLf2):I.dvz=K,I.ctrl_z=1),I.itr)for(const n of I.itr)n.kind===y.w7.SuperPunchMe&&(!n.vrest||n.vrest<I.wait)&&(n.vrest=I.wait);dn(I)}return t}function ln(e){var n;if("string"===typeof e)return null===(n=e.match(/#(.*)[\n|\r|\0]*/))||void 0===n?void 0:n[1]}const _n={[y.$5.None]:{on_ground:"",just_on_ground:"",throw_on_ground:""},[y.$5.Stick]:{on_ground:"60",just_on_ground:"70",throw_on_ground:"71"},[y.$5.Heavy]:{on_ground:"20",just_on_ground:"21",throw_on_ground:"71"},[y.$5.Knife]:{on_ground:"60",just_on_ground:"70",throw_on_ground:"71"},[y.$5.Baseball]:{on_ground:"60",just_on_ground:"70",throw_on_ground:"71"},[y.$5.Drink]:{on_ground:"60",just_on_ground:"70",throw_on_ground:"71"}};function hn(e,n,t,a){var i,s,r;switch(e.name=null!==(i=a.hash)&&void 0!==i?i:a.file.replace(/[^a-z|A-Z|0-9|_]/g,""),""+a.type){case"1":e.bounce=.2,e.type=null!==(s={120:y.$5.Knife,124:y.$5.Knife}[""+a.id])&&void 0!==s?s:y.$5.Stick;break;case"2":if(e.type=y.$5.Heavy,"150"===a.id)e.bounce=.2;else e.bounce=.1;break;case"4":e.type=y.$5.Baseball,e.bounce=.45;break;case"6":e.type=y.$5.Drink,e.bounce=.45}const o=function(e){var n;const t=null===(n=h(e,"<weapon_strength_list>","<weapon_strength_list_end>"))||void 0===n?void 0:n.trim();if(!(0,S.rE)(t))return;const a=u(t,/entry:\s*(\d+)\s*(\S+)\s*\n?(.*)\n?/g).map(e=>{let[,n,t,a]=e;const i={id:n,name:t};for(const[r,o]of f(a)){var s;i[r]=null!==(s=B(o))&&void 0!==s?s:o}return sn(i),i});if(!a.length)return;const i={};for(const s of a)i[s.id]=s;return i}(n),d=null!==(r=_n[e.type])&&void 0!==r?r:_n[y.$5.None],c=(0,X.$)(e,"weapon_broken_sound");c&&(e.dead_sounds=[c.replace(/\\/g,"/")+".mp3"]);const _=(0,X.$)(e,"weapon_drop_sound");_&&(e.drop_sounds=[_.replace(/\\/g,"/")+".mp3"]);const p=(0,X.$)(e,"weapon_hit_sound");p&&(e.hit_sounds=[p.replace(/\\/g,"/")+".mp3"]);const g=(0,X.$)(e,"weapon_drop_hurt");g&&Number(g)&&(e.drop_hurt=Number(g));const v=(0,X.$)(e,"weapon_hp");v&&Number(v)&&(e.hp=Number(v));const b=[],k=[],w=[];return(0,m.R)(t,(e,n)=>{n.state!==y.Fb.Weapon_InTheSky&&n.state!==y.Fb.HeavyWeapon_InTheSky||b.push(e),n.state!==y.Fb.Weapon_Throwing&&n.state!==y.Fb.HeavyWeapon_InTheSky||k.push(e),n.state!==y.Fb.Weapon_OnHand&&n.state!==y.Fb.HeavyWeapon_OnHand||w.push(e)}),d.in_the_skys=b.length?b:void 0,d.throwings=b.length?k:void 0,d.on_hands=w.length?w:void 0,{id:"",on_dead:{id:y.Vp.Gone},type:l.D2.Weapon,base:e,itr_prefabs:o,frames:t,indexes:d}}var un=t(6744);const pn=(0,un.B)(0,3).map(e=>""+e),fn=(0,un.B)(4,7).map(e=>""+e),gn=(0,un.B)(10,13).map(e=>""+e),mn=(0,un.B)(14,17).map(e=>""+e),vn=(0,un.B)(20,23).map(e=>""+e),yn=(0,un.B)(24,27).map(e=>""+e),bn=(0,un.B)(30,33).map(e=>""+e),kn=(0,un.B)(40,43).map(e=>""+e),wn=(0,un.B)(44,47).map(e=>""+e),Cn=(0,un.B)(50,53).map(e=>""+e),xn=(0,un.B)(54,57).map(e=>""+e),An=(0,un.B)(60,63).map(e=>""+e),Pn=(0,un.B)(70,73).map(e=>""+e),Fn=(0,un.B)(74,77).map(e=>""+e),Tn=(0,un.B)(80,83).map(e=>""+e),En=((0,un.B)(120,123).map(e=>""+e),(0,un.B)(125,128).map(e=>""+e),(0,un.B)(130,133).map(e=>""+e),(0,un.B)(130,133).map(e=>""+e),(0,un.B)(135,138).map(e=>""+e),(0,un.B)(140,143).map(e=>""+e),(0,un.B)(150,153).map(e=>""+e)),Bn=(0,un.B)(154,157).map(e=>""+e),Sn=(0,un.B)(160,163).map(e=>""+e),Wn=(0,un.B)(164,167).map(e=>""+e),Nn=(0,un.B)(170,173).map(e=>""+e),zn=(0,un.B)(174,177).map(e=>""+e);y.Tc.WEAPON_WEIGHT_HEAVY;const In=function(){const e=[{dvy:5,dvx:-1},{dvy:5,dvx:1},{dvy:3},{dvy:2,dvx:2},{dvy:2,dvx:-2},{dvy:4,dvx:-1.5},{dvy:4,dvx:1.5},{dvy:2},{dvy:1,dvx:1},{dvy:1,dvx:-1}];for(var n=arguments.length,t=new Array(n),a=0;a<n;a++)t[a]=arguments[a];return t.map((n,t)=>({kind:A.E.Normal,x:0,y:0,origin_type:1,action:{id:n},oid:"999",...e[t%e.length]}))},Dn=new Set;function jn(e,n){if((e=e.replace(/\\\\/g,"/")).startsWith("<stage>"))return function(e){const n=[],t=V(e=e.replace(/<phase_end>[\n|\s|\r]*<stage>/g,"<phase_end><stage_end><stage>"),"<stage>","<stage_end>");e=t.remains;for(let d of t.blocks){var a;const e={bg:"0",id:"",name:"",phases:[]},t=V(d,"<phase>","<phase_end>");d=t.remains;for(let n of t.blocks){const t={bound:0,desc:"",objects:[]};for(let e of n.trim().split("\n"))if(e=e.trim(),e)if(e.startsWith("bound")){var i,s;for(const[n,a]of f(e)){var r;"bound"===n&&(t.bound=null!==(r=B(a))&&void 0!==r?r:t.bound),"music"===n&&(t.music=a.replace(/\\/g,"/")+".mp3")}t.desc=null!==(i=null===(s=ln(e))||void 0===s?void 0:s.trim())&&void 0!==i?i:""}else if(e.startsWith("music"))for(const[n,a]of f(e))"music"===n&&(t.music=a.replace(/\\/g,"/")+".mp3");else if(e.startsWith("id")){const n={id:[],x:t.bound};e.indexOf("<soldier>")>=0&&(n.is_soldier=!0),e.indexOf("<boss>")>=0&&(n.is_boss=!0);for(const[t,a]of f(e)){var o;"id"===t?n.id=[a]:"act"===t?n.act=a:n[t]=null!==(o=B(a))&&void 0!==o?o:n[t]}t.objects.push(n)}e.phases.push(t)}const c=d.replace(/\s+\n+/g,"\n").trim();for(const[n,a]of f(c))e[n]=a;const l=Number(e.id);e.name=(null!==(a=ln(c))&&void 0!==a?a:e.id).replace(/stage/gi,"").trim(),l%10===0&&(e.is_starting=!0,e.starting_name=""+(1+l/10));for(const n of e.phases)n.enemy_r=n.bound+200,n.enemy_l=-200;if(l<49&&e.phases[0]&&(e.phases[0].health_up=e.phases[0].respawn={[y.sL.Easy]:200,[y.sL.Normal]:150,[y.sL.Difficult]:100,[y.sL.Crazy]:50},e.phases[0].mp_up={[y.sL.Easy]:500,[y.sL.Normal]:500,[y.sL.Difficult]:500,[y.sL.Crazy]:500}),50===l)for(const n of e.phases)n.respawn={[y.sL.Easy]:300,[y.sL.Normal]:150,[y.sL.Difficult]:5,[y.sL.Crazy]:5};if(50===l){e.starting_name="Survival",e.chapter="survival",e.bg="8",e.title="SURVIVAL STAGE";for(const n of e.phases)n.drink_l=0,n.drink_r=n.bound}l<=9?(e.bg="2",e.chapter="chapter_1",e.title=`STAGE 1-${l+1}`,l<9&&(e.next=""+(l+1))):l<=19?(e.bg="3",e.chapter="chapter_2",e.title="STAGE 2-"+(l+1-10),l<19&&(e.next=""+(l+1))):l<=29?(e.bg="5",e.chapter="chapter_3",e.title="STAGE 3-"+(l+1-20),l<29&&(e.next=""+(l+1))):l<=39?(e.bg="6",e.chapter="chapter_4",e.title="STAGE 4-"+(l+1-30),l<39&&(e.next=""+(l+1))):l<=49&&(e.bg="7",e.chapter="chapter_5",e.title="STAGE 5-"+(l+1-40),l<49&&(e.next=""+(l+1))),n.push(e)}for(const d of n){const e=d.phases[0];if(!e)return;e.cam_jump_to_x=0,e.player_jump_to_x=0}n.sort((e,n)=>Number(e.id)-Number(n.id));for(const d of n){if(!d.next)continue;if(n.find(e=>e.id===d.next))continue;delete d.next;const e=Number(d.id);e<=9?d.next="10":e<=19?d.next="20":e<=29?d.next="30":e<=39&&(d.next="40")}return n}(e);if(e.startsWith("name:"))return q(e,n);const t=h(e,"<bmp_begin>","<bmp_end>");if(!t)return;let a;const i={name:"",files:{}};for(const s of t.trim().split("\n")){let e;if(e=s.match(/name:\s*(\S*)/),e)i.name=e[1];else if(e=s.match(/head:\s*(\S*)/),e)i.head=e[1].replace(/.bmp$/,".png").replace(/\\/g,"/");else if(e=s.match(/small:\s*(\S*)/),e)i.small=e[1].replace(/.bmp$/,".png").replace(/\\/g,"/");else{if(s.startsWith("file(")){const e=i.files?Object.keys(i.files).length:0,n={id:""+e,path:"",row:0,col:0,cell_w:0,cell_h:0};for(const[t,a]of f(s))t.startsWith("file")?n.path=a.replace(/.bmp$/,".png").replace(/\\/g,"/"):"w"===t?n.cell_w=Number(a):"h"===t?n.cell_h=Number(a):n[t]=Number(a);i.files=_(i.files,""+e,n);continue}e=s.match(/(\S*)\s*:\s*([+-]?([0-9]*[.])?[0-9]+)/),e?i[e[1]]=Number(e[2]):(e=s.match(/(\S*)\s*:\s*(\S*)/),e?i[e[1]]=e[2]:(e=s.match(/(\S*)\s*([+-]?([0-9]*[.])?[0-9]+)/),e?i[e[1]]=Number(e[2]):(e=s.match(/(\S*)\s*(\S*)/),e&&(i[e[1]]=e[2]))))}}switch(""+n.type){case"0":a=de(i,cn(e,i.files));break;case"1":case"2":case"4":case"6":a=hn(i,e,cn(e,i.files),n);break;case"3":a=K(i,cn(e,i.files),n);break;case"5":a=Z(i,cn(e,i.files));break;default:console.warn("[dat_to_json] unknow dat type:",JSON.stringify(n.type)),a=Z(i,cn(e,i.files))}switch(a&&(a.id=n.id),a.base.name||(a.base.name=a.type+"_"+a.id),a.type){case l.D2.Entity:break;case l.D2.Fighter:Ve(a);break;case l.D2.Weapon:!function(e){const n=Number(e.id);switch((n>=100||n<=199)&&(e.base.group=(0,g.D8)(e.base.group,y.hG.VsWeapon,y.hG.StageWeapon)),e.id){case y.PC.HenryArrow1:e.base.weight=y.Tc.WEAPON_WEIGHT_ARROW,delete e.base.group,(0,T.X)(e.frames,e=>{e.state!==y.Fb.Weapon_Rebounding?(0,T.X)(e.itr,(e,n)=>{if(Dn.has(e))throw new Error("already handle!");Dn.add(e),e.actions=(0,g.D8)(e.actions,{type:b.X.A_NextFrame,data:{id:y.Vp.Gone},pretest:!0,test:(new W).add(w.W.VictimType,"==",y.D2.Fighter).and(w.W.BdyKind,"==",y.aW.Normal).and(w.W.VictimState,"!=",y.Fb.Defend).and(w.W.ArmorWork,"==",0).done()})}):delete e.itr});break;case y.PC.RudolfWeapon:e.base.weight=y.Tc.WEAPON_WEIGHT_ARROW,delete e.base.group,(0,T.X)(e.frames,e=>{e.state!==y.Fb.Weapon_Rebounding||delete e.itr});break;case y.PC.Weapon_Stick:e.base.weight=y.Tc.WEAPON_WEIGHT_NOMRAL,e.base.brokens=In(gn,gn,mn,mn,mn);break;case y.PC.Weapon_Hoe:e.base.weight=y.Tc.WEAPON_WEIGHT_HOE,e.base.brokens=In(bn,bn,vn,vn,yn,yn);break;case y.PC.Weapon_Knife:e.base.weight=y.Tc.WEAPON_WEIGHT_LIGHT,e.base.brokens=In(bn,bn,yn,yn);break;case y.PC.Weapon_baseball:e.base.weight=y.Tc.WEAPON_WEIGHT_BASEBALL,e.base.brokens=In(...(0,g.v_)(5,()=>An));break;case y.PC.Weapon_milk:e.base.weight=y.Tc.WEAPON_WEIGHT_LIGHT,e.base.brokens=In(Pn,...(0,g.v_)(4,()=>Tn),...(0,g.v_)(5,()=>Fn)),e.base.group=[y.hG.VsWeapon],e.base.drink={hp_h_total:160,hp_h_value:4,hp_h_ticks:5,hp_r_total:80,hp_r_value:2,hp_r_ticks:5,mp_h_total:166,mp_h_value:5,mp_h_ticks:6};break;case y.PC.Weapon_Stone:e.base.weight=y.Tc.WEAPON_WEIGHT_HEAVY,e.base.brokens=In(pn,pn,fn,fn,fn);break;case y.PC.Weapon_WoodenBox:e.base.weight=y.Tc.WEAPON_WEIGHT_HEAVY,e.base.brokens=In(kn,wn,Cn,xn,xn);break;case y.PC.Weapon_Beer:e.base.weight=y.Tc.WEAPON_WEIGHT_LIGHT,e.base.brokens=In(Sn,Wn,Wn,Wn,Wn,Fn,Fn,Fn,Fn,Fn),e.base.group=(0,g.D8)(e.base.group,y.hG.VsWeapon),e.base.drink={mp_h_total:750,mp_h_value:12,mp_h_ticks:1};break;case y.PC.Weapon_Boomerang:e.base.weight=y.Tc.WEAPON_WEIGHT_LIGHT,e.base.brokens=In(Nn,Nn,Nn);break;case y.PC.Weapon_LouisArmourA:case y.PC.Weapon_LouisArmourB:e.base.weight=y.Tc.WEAPON_WEIGHT_HEAVY,delete e.base.group,e.base.brokens=In(zn,zn,zn,zn,zn);break;case y.PC.Weapon_IceSword:e.base.weight=y.Tc.WEAPON_WEIGHT_NOMRAL,delete e.base.group,e.base.brokens=In(En,En,En,Bn,Bn,Bn,Bn)}}(a);break;case l.D2.Ball:!function(e){switch(e.id){case y.PC.FirenFlame:(0,m.R)(e.frames,(e,n)=>{if(n.itr)for(const t of n.itr)t.hit_flag=k._0.AllEnemy});break;case y.PC.FirzenBall:case y.PC.BatBall:(0,m.R)(e.frames,(e,n)=>{n.no_shadow=1});break;case y.PC.JanChase:e.frames[50].invisible=e.frames[50].wait,e.frames[51].invisible=e.frames[51].wait,e.frames[52].invisible=e.frames[52].wait,(0,m.R)(e.frames,(e,n)=>{n.behavior===y.q.ChasingSameEnemy&&(n.opoint=(0,g.D8)(n.opoint,{oid:y.PC.JanChase,action:{id:"40"},x:n.centerx,y:n.centery,kind:y.EC.Normal,is_entity:!1,speedz:0,dvx:0,dvy:0,dvz:0,interval:1,interval_id:"1",interval_mode:1}));const t=(0,g.I6)(n.opoint,e=>e.oid===y.PC.JanChase&&"40"===e.action.id);t&&(t.speedz=t.dvx=t.dvy=t.dvz=0,t.is_entity=!1)});break;case y.PC.JanChaseh:e.frames[50].invisible=e.frames[50].wait,e.frames[51].invisible=e.frames[51].wait,e.frames[52].invisible=e.frames[52].wait,(0,m.R)(e.frames,(e,n)=>{const t=(0,g.I6)(n.opoint,e=>e.oid===y.PC.JanChaseh&&"40"===e.action.id);t&&(t.speedz=t.dvx=t.dvy=t.dvz=0,t.is_entity=!1)});break;case y.PC.FirzenChasef:e.frames[59].invisible=e.frames[59].wait,e.frames[80].invisible=e.frames[80].wait,e.frames[81].invisible=e.frames[81].wait,(0,m.R)(e.frames,(e,n)=>{n.behavior===y.q.ChasingSameEnemy&&(n.opoint=(0,g.D8)(n.opoint,{oid:y.PC.FirzenChasef,action:{id:"40"},x:(0,g.RI)(n.pic.w/2),y:(0,g.RI)(n.pic.h/2),kind:y.EC.Normal,is_entity:!1,speedz:0,dvx:0,dvy:0,dvz:0,interval:1,interval_id:"1",interval_mode:1}))});break;case y.PC.FirzenChasei:(0,m.R)(e.frames,(e,n)=>{n.behavior===y.q.ChasingSameEnemy&&(n.opoint=(0,g.D8)(n.opoint,{oid:y.PC.FirzenChasei,action:{id:"40"},x:(0,g.RI)(n.pic.w/2),y:(0,g.RI)(n.pic.h/2),kind:y.EC.Normal,is_entity:!1,speedz:0,dvx:0,dvy:0,dvz:0,interval:1,interval_id:"1",interval_mode:1}))});break;case y.PC.DeepBall:case y.PC.DennisBall:case y.PC.WoodyBall:case y.PC.DavisBall:case y.PC.DennisChase:case y.PC.JackBall:case y.PC.JohnBall:e.base.group=(0,g.D8)(e.base.group,y.hG.FreezableBall);break;case y.PC.JohnBiscuit:(0,T.X)(e.frames,e=>{(0,T.X)(e.bdy,e=>{e.actions=(0,g.D8)([],{type:b.X.V_REBOUND_VX,test:(new W).or(w.W.ItrKind,"==",y.w7.JohnShield).done(),data:""},{type:b.X.V_TURN_FACE,test:(new W).or(w.W.ItrKind,"==",y.w7.JohnShield).done(),data:""},{type:b.X.V_TURN_TEAM,test:(new W).or(w.W.ItrKind,"==",y.w7.JohnShield).done(),data:""},{type:b.X.V_NextFrame,test:(new W).one_of(w.W.AttackerState,y.Fb.Ball_3005,y.Fb.Ball_3006).and(w.W.ItrKind,"!=",y.w7.JohnShield).done(),data:{id:"20"}})})});case y.PC.Template:case y.PC.Julian:case y.PC.Firzen:case y.PC.LouisEX:case y.PC.Bat:case y.PC.Justin:case y.PC.Knight:case y.PC.Jan:case y.PC.Monk:case y.PC.Sorcerer:case y.PC.Jack:case y.PC.Mark:case y.PC.Hunter:case y.PC.Bandit:case y.PC.Deep:case y.PC.John:case y.PC.Henry:case y.PC.Rudolf:case y.PC.Louis:case y.PC.Firen:case y.PC.Freeze:case y.PC.Dennis:case y.PC.Woody:case y.PC.Davis:case y.PC.Weapon0:case y.PC.Weapon2:case y.PC.Weapon4:case y.PC.Weapon5:case y.PC.Weapon6:case y.PC.Weapon1:case y.PC.Weapon3:case y.PC.Weapon8:case y.PC.Weapon9:case y.PC.Weapon10:case y.PC.Weapon11:case y.PC.Criminal:case y.PC.HenryArrow1:case y.PC.RudolfWeapon:case y.PC.HenryWind:case y.PC.HenryArrow2:case y.PC.FreezeBall:case y.PC.FirenBall:case y.PC.FreezeColumn:case y.PC.Weapon7:case y.PC.BatChase:case y.PC.JustinBall:case y.PC.JulianBall:case y.PC.JulianBall2:case y.PC.Etc:case y.PC.BrokenWeapon:}}(a)}return function(e){(0,T.X)(e.frames,e=>{(0,X.$)(e,"hit_a"),(0,X.$)(e,"hit_j"),(0,X.$)(e,"hit_d"),(0,X.$)(e,"hit_Fa"),(0,X.$)(e,"hit_Fj"),(0,X.$)(e,"hit_Ua"),(0,X.$)(e,"hit_Uj"),(0,X.$)(e,"hit_Da"),(0,X.$)(e,"hit_Dj"),(0,X.$)(e,"hit_Ua"),(0,X.$)(e,"hit_ja")})}(a),v.check_all(),v.builders.length=0,a}const Hn="SiuHungIsAGoodBearBecauseHeIsVeryGood",Gn=123;async function $n(e){const n=new Uint8Array(e);!function(e,n){for(let t=0;t<n;++t)e[t]-=Hn.charCodeAt(t%Hn.length)}(n,n.byteLength);const t=Array.from(n);return t.splice(0,Gn),String.fromCharCode(...t)}var Xn=t(8255),Rn=t(3977),Kn=t(579);function Ln(e){const{files:n}=e,t=(0,s.useRef)(null),[a,i]=(0,s.useState)(0);return(0,s.useEffect)(()=>{const e=t.current;if(!e)return;const n=()=>{i(e.getBoundingClientRect().height||0)},a=new ResizeObserver(n);return a.observe(e),n(),()=>a.disconnect()},[]),(0,Kn.jsx)(d.A,{style:{height:"100%",width:"100%",paddingLeft:0,paddingRight:0,paddingBottom:0,flexDirection:"column",overflow:"hidden",display:"flex"},label:"\u6587\u4ef6\u5217\u8868",variants:["no_border","no_shadow","no_round"],children:(0,Kn.jsx)("div",{ref:t,style:{position:"relative",overflow:"hidden",height:1,flex:1},children:(0,Kn.jsx)(Rn.A,{data:n,height:a,itemHeight:32,itemKey:"name",styles:{verticalScrollBarThumb:{backgroundColor:"rgba(0,0,0,0.2)"}},virtual:!0,style:{resize:"horizontal",width:"100%"},children:n=>(0,Kn.jsx)(r.$,{styles:{inner:{textAlign:"left",width:"100%"}},variants:["no_border","no_shadow","no_round"],onClick:t=>{var a;null===(a=e.onClick)||void 0===a||a.call(e,n),t.stopPropagation(),t.preventDefault()},children:n.name})})})})}var Mn=t(8405);function On(e){const{onClose:n,loading:t,open:a,...l}=e,_=(0,s.useRef)(null),u=(0,s.useRef)(null),p=(0,s.useRef)(""),g=(0,s.useRef)(""),[m,v]=(0,s.useState)([]),y=(0,s.useRef)(null),b=async e=>{if(e.name.endsWith(".txt")){const n=await(0,Xn.We)(e,{as:"Text"}).then(e=>e.replace(/\r/g,"")),t=function(e,n){var t,a;if(!e)return;const i=null===(t=h(e,"<object>","<object_end>"))||void 0===t?void 0:t.split(/\n|\r/).filter(e=>e).map(e=>{const t={id:"",type:"",file:""};for(const[i,s]of f(e))switch(i){case"id":case"type":t[i]=s;break;case"file":t[i]=s.replace(/\\/g,"/").replace(/.dat$/,`.${n}`)}const a=ln(e);return a&&(t.hash=a),"217"===t.id&&(t.hash="louis_limbs_armour"),"216"===t.id&&(t.hash="louis_body_armour"),"124"===t.id&&(t.hash="boomerang"),"201"===t.id&&(t.hash="henry_arrow"),"202"===t.id&&(t.hash="rudolf_weapon"),t}),s=null===(a=h(e,"<background>","<background_end>"))||void 0===a?void 0:a.split(/\n|\r/).filter(e=>e).map(e=>{const t={id:"",type:"bg",file:""};for(const[a,i]of f(e))switch(a){case"id":t[a]="bg_"+i;break;case"file":t[a]=i.replace(/\\/g,"/").replace(/.dat$/,`.${n}`)}return t});return i&&s?{objects:i,backgrounds:s}:void 0}(n,"json5");t&&(y.current=t),p.current=n,g.current=i().stringify(t,null,2),_.current&&(_.current.value=p.current),u.current&&(u.current.value=g.current)}else if(e.name.endsWith(".dat")){var n,t;const a=await(0,Xn.We)(e,{as:"ArrayBuffer"}),s=await $n(a),r="data/"+e.name.replace(/\.dat$/,".json5").replace(/\\/g,"/"),o=(null===(n=y.current)||void 0===n?void 0:n.objects.find(e=>r===e.file))||(null===(t=y.current)||void 0===t?void 0:t.backgrounds.find(e=>r===e.file)),d=jn(s,o);p.current=s,g.current=i().stringify(d,null,2),_.current&&(_.current.value=p.current),u.current&&(u.current.value=g.current)}},k=(0,s.useRef)(null),{context:w,workspace:C,set_container:x}=(0,Mn.C)({container:k.current,render:(0,s.useCallback)((e,n,t)=>{switch(e.id){case"files":return(0,Kn.jsx)(Ln,{files:m,onClick:b});case"dat_txt":return(0,Kn.jsx)(c.f,{variants:["no_border","no_shadow","no_round"],ref:_,wrap:"off",style:{resize:"none",width:"100%",height:"100%"}});case"json5_txt":return(0,Kn.jsx)(c.f,{variants:["no_border","no_shadow","no_round"],ref:u,wrap:"off",style:{resize:"none",width:"100%",height:"100%"}})}return(0,Kn.jsx)(Kn.Fragment,{children:e.id})},[m]),key:(0,s.useCallback)((e,n,t)=>"slot_"+e.id||0,[])});return(0,s.useEffect)(()=>x(k.current),[]),(0,s.useEffect)(()=>{if(C)return C.add(0,0,{id:"files"}),C.add("files","right",{id:"dat_txt"}),C.add("dat_txt","down",{id:"json5_txt"}),C.confirm(),()=>{C.del("files"),C.del("dat_txt"),C.del("json5_txt")}},[C]),a?(0,Kn.jsxs)(o.s,{direction:"column",align:"stretch",...l,children:[(0,Kn.jsxs)(d.A,{variants:["no_shadow","no_round"],style:{padding:0,borderTop:"none",borderLeft:"none",borderRight:"none",borderBottom:"1px solid #5555CC55",boxSizing:"border-box"},children:[(0,Kn.jsx)(r.$,{variants:["no_border","no_shadow","no_round"],onClick:n,disabled:t,children:"\u2715"}),(0,Kn.jsx)(r.$,{variants:["no_border","no_shadow","no_round"],onClick:()=>(async()=>{const e=await(0,Xn.$z)();v(e);const n=e.find(e=>"data.txt"===e.name);n&&b(n)})().catch(console.warn),disabled:t,children:"\u6253\u5f00\u76ee\u5f55"})]}),(0,Kn.jsx)(d.A,{variants:["no_border","no_shadow","no_round"],style:{flex:1,overflow:"hidden",boxSizing:"border-box"},ref:k}),w]}):(0,Kn.jsx)(Kn.Fragment,{})}}}]);
//# sourceMappingURL=683.5d53974d.chunk.js.map