{"version":3,"file":"static/js/863.aba5b6f0.chunk.js","mappings":"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","sources":["EditorView/FrameEditorView/ItrEditor.tsx","Component/TabButtons/index.tsx","EditorView/FrameEditorView/useThrough.tsx","EditorView/FrameEditorView/index.tsx","LF2/utils/array/map_arr.ts","../node_modules/classnames/index.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { Button } from \"../../Component/Buttons/Button\";\r\nimport Combine from \"../../Component/Combine\";\r\nimport { Flex } from \"../../Component/Flex\";\r\nimport Frame, { IFrameProps } from \"../../Component/Frame\";\r\nimport { Input } from \"../../Component/Input\";\r\nimport Select from \"../../Component/Select\";\r\nimport Show from \"../../Component/Show\";\r\nimport { TextArea } from \"../../Component/TextArea\";\r\nimport Titled, { ITitledProps } from \"../../Component/Titled\";\r\nimport { Defines, HitFlag, IItrInfo, itr_effect_full_name, itr_kind_full_name, ItrEffect, ItrKind } from \"../../LF2/defines\";\r\nimport { floor } from \"../../LF2/utils\";\r\nimport { ITR_EFFECT_SELECT_PROPS, ITR_KIND_SELECT_PROPS } from \"../EntityEditorView\";\r\nimport { HitFlagEditor } from \"./HitFlagEditor\";\r\nimport { make_field_props, make_not_blank_field_props } from \"./make_field_props\";\r\nimport { QubeEdit } from \"./QubeEdit\";\r\n\r\nexport interface IItrEditorViewProps extends IFrameProps {\r\n  label?: string;\r\n  value?: IItrInfo;\r\n  defaultValue?: IItrInfo\r\n  onChange?(value?: IItrInfo): void;\r\n  onRemove?(): void;\r\n}\r\nconst titled_styles: ITitledProps['styles'] = {\r\n  label: {\r\n    width: 70,\r\n    textAlign: 'end'\r\n  }\r\n}\r\nconst default_value: IItrInfo = {\r\n  hit_flag: HitFlag.AllEnemy,\r\n  kind: ItrKind.Normal,\r\n  effect: ItrEffect.Normal,\r\n  z: floor(-Defines.DAFUALT_QUBE_LENGTH / 2),\r\n  l: floor(Defines.DAFUALT_QUBE_LENGTH),\r\n  x: 0,\r\n  y: 0,\r\n  w: 0,\r\n  h: 0\r\n}\r\nexport function ItrEditor(props: IItrEditorViewProps) {\r\n  const { label = 'itr info', value, defaultValue = default_value, onRemove, onChange, ..._p } = props;\r\n  const kind = value?.kind ?? defaultValue.kind;\r\n  const is_vrest = !!value && 'vrest' in value;\r\n  return (\r\n    <Frame key={label} label={label} tabIndex={-1} {..._p}>\r\n      <Button style={{ position: 'absolute', right: 0, top: 0, border: 'none' }} onClick={onRemove}>\r\n        🗑️\r\n      </Button>\r\n      <Flex direction='column' align='stretch' gap={5}>\r\n        <Titled label='类型' styles={titled_styles}>\r\n          <Combine>\r\n            <Select\r\n              {...ITR_KIND_SELECT_PROPS}\r\n              {...make_field_props(props, default_value, 'kind', (v) => {\r\n                v.kind_name = itr_kind_full_name(v.kind);\r\n                if (v.kind !== ItrKind.Normal) {\r\n                  delete v.effect;\r\n                  delete v.effect_name;\r\n                }\r\n                return v;\r\n              })}\r\n              data-flex={1}\r\n            />\r\n            <Show show={kind === ItrKind.Normal} data-flex={1}>\r\n              <Select\r\n                {...ITR_EFFECT_SELECT_PROPS}\r\n                {...make_field_props(props, default_value, 'effect', (v) => {\r\n                  v.effect_name = itr_effect_full_name(v.effect)\r\n                  return v;\r\n                })}\r\n              />\r\n            </Show>\r\n          </Combine>\r\n        </Titled>\r\n        <Titled label='判定' styles={titled_styles}>\r\n          <HitFlagEditor {...make_field_props(props, default_value, 'hit_flag')} />\r\n        </Titled>\r\n        <Flex direction='row'>\r\n          <Titled label='自身停顿' styles={titled_styles} style={{ flex: 1 }}>\r\n            <Input.Number\r\n              {...make_not_blank_field_props(props, default_value, 'motionless')}\r\n              clearable\r\n              placeholder={'' + Defines.DEFAULT_ITR_MOTIONLESS}\r\n              step={1} />\r\n          </Titled>\r\n          <Titled label='目标停顿' style={{ flex: 1 }}>\r\n            <Input.Number\r\n              {...make_not_blank_field_props(props, default_value, 'shaking')}\r\n              clearable\r\n              placeholder={'' + Defines.DEFAULT_ITR_SHAKING}\r\n              step={1} />\r\n          </Titled>\r\n        </Flex>\r\n        <Titled label='rest' styles={titled_styles}>\r\n          <Combine>\r\n            <Select\r\n              items={['arest', 'vrest'] as const}\r\n              parse={v => [v, v]}\r\n              value={is_vrest ? 'vrest' : 'arest'}\r\n              onChange={(v: 'arest' | 'vrest' | undefined) => {\r\n                const next = { ...(value || defaultValue) };\r\n                const rest = next.arest || next.vrest || 0;\r\n                delete next.arest;\r\n                delete next.vrest;\r\n                next[v!] = rest\r\n                onChange?.(next)\r\n              }} />\r\n            <Input.Number\r\n              data-flex={1}\r\n              {...make_not_blank_field_props(props, default_value, is_vrest ? 'vrest' : 'arest')}\r\n              placeholder={'' + Defines.DEFAULT_ITR_MOTIONLESS}\r\n              clearable\r\n              step={1} />\r\n          </Combine>\r\n        </Titled>\r\n        <Flex direction='row'>\r\n          <Titled label='击倒值' styles={titled_styles} style={{ flex: 1 }}>\r\n            <Input.Number {...make_not_blank_field_props(props, default_value, 'fall')} placeholder={'' + Defines.DEFAULT_ITR_FALL} clearable step={1} />\r\n          </Titled>\r\n          <Titled label='破防值' style={{ flex: 1 }}>\r\n            <Input.Number {...make_not_blank_field_props(props, default_value, 'bdefend')} clearable step={1} />\r\n          </Titled>\r\n          <Titled label='伤害值' style={{ flex: 1 }}>\r\n            <Input.Number {...make_not_blank_field_props(props, default_value, 'injury')} clearable step={1} />\r\n          </Titled>\r\n        </Flex>\r\n        <Titled label='包围盒' styles={titled_styles}>\r\n          <QubeEdit\r\n            value={value}\r\n            defaultValue={defaultValue}\r\n            onChange={v => onChange?.({ ...defaultValue, ...value, ...v })} />\r\n        </Titled>\r\n        <Titled label='条件' styles={titled_styles}>\r\n          <TextArea {...make_not_blank_field_props(props, default_value, 'test')} style={{ resize: 'vertical' }} />\r\n        </Titled>\r\n        <Titled label='预设' styles={titled_styles}>\r\n          <Input {...make_not_blank_field_props(props, default_value, 'prefab_id')} clearable />\r\n        </Titled>\r\n      </Flex>\r\n    </Frame>\r\n  )\r\n}\r\nItrEditor.genValue = (fn?: (edit: IItrInfo) => IItrInfo) => fn ? fn({ ...default_value }) : { ...default_value }\r\nexport default function ItrEditorTestView(props: {}) {\r\n  const [value, set_value] = useState<IItrInfo | undefined>(default_value)\r\n  return (\r\n    <Flex direction='column' gap={10}>\r\n      <TextArea style={{ resize: 'vertical', height: 500 }} readOnly value={JSON.stringify(value, null, 2)} />\r\n      <ItrEditor value={value} onChange={set_value} />\r\n    </Flex>\r\n  )\r\n};","import { Button } from \"../Buttons/Button\";\r\nimport Combine, { ICombineProps } from \"../Combine\";\r\n\r\nexport interface ITabButtonsProps<V extends number | string, I> extends Omit<ICombineProps, 'children' | 'onChange'> {\r\n  value?: V;\r\n  items?: I[];\r\n  parse?(item: I, idx: number, items: I[]): [V, React.ReactNode];\r\n  onChange?(value: V | undefined, e: React.MouseEvent): void;\r\n  disabled?: boolean;\r\n  classNames?: {\r\n    button?: string\r\n  },\r\n  styles?: {\r\n    button?: React.CSSProperties\r\n  }\r\n}\r\nexport function TabButtons<V extends number | string, I>(props: ITabButtonsProps<V, I>) {\r\n  const { value, items, parse, onChange, disabled, classNames, styles,..._p } = props;\r\n\r\n  return (\r\n    <Combine {..._p} >\r\n      {\r\n        items?.map((item, idx, items) => {\r\n          const [v, label] = parse?.(item, idx, items) || []\r\n          return (\r\n            <Button\r\n              className={classNames?.button}\r\n              style={styles?.button}\r\n              key={idx}\r\n              onClick={(e) => v === value ? void 0 : onChange?.(v, e)}\r\n              actived={v === value}\r\n              disabled={disabled}\r\n              data-flex={1}>\r\n              {label}\r\n            </Button>\r\n          )\r\n        })\r\n      }\r\n    </Combine>\r\n  )\r\n}","import { useRef } from \"react\";\n\nexport function useThrough<F extends (...args: any[]) => any>(func: F | undefined | null, mine: F): F {\n  const ref_func = useRef(func);\n  ref_func.current = func;\n  const ret: F = ((...args: Parameters<F>) => {\n    ref_func.current?.(...args);\n    return mine(...args);\n  }) as F;\n  return ret;\n}\n","import { useRef, useState } from \"react\";\r\nimport { Button } from \"../../Component/Buttons/Button\";\r\nimport { Flex } from \"../../Component/Flex\";\r\nimport Frame, { IFrameProps } from \"../../Component/Frame\";\r\nimport Show from \"../../Component/Show\";\r\nimport { Space } from \"../../Component/Space\";\r\nimport { TabButtons } from \"../../Component/TabButtons\";\r\nimport { TextArea } from \"../../Component/TextArea\";\r\nimport { IFrameInfo, IItrInfo } from \"../../LF2/defines\";\r\nimport { IEntityData } from \"../../LF2/defines/IEntityData\";\r\nimport { ensure } from \"../../LF2/utils\";\r\nimport { map_arr } from \"../../LF2/utils/array/map_arr\";\r\nimport { ItrEditor } from \"./ItrEditor\";\r\nimport { IFieldProps } from \"./make_field_props\";\r\nimport { useThrough } from \"./useThrough\";\r\nconst TAG = 'FrameEditor'\r\nenum TabEnum {\r\n  Base = 'base',\r\n  Spd = 'spd',\r\n  Itr = 'itr',\r\n  Bdy = 'bdy',\r\n  Cpoint = 'cpoint',\r\n  Opoint = 'opoint',\r\n  Bpoint = 'bpoint'\r\n}\r\nconst tab_labels: Record<TabEnum, string> = {\r\n  [TabEnum.Base]: \"基础\",\r\n  [TabEnum.Spd]: \"速度\",\r\n  [TabEnum.Itr]: \"攻击\",\r\n  [TabEnum.Bdy]: \"身体\",\r\n  [TabEnum.Cpoint]: \"持械\",\r\n  [TabEnum.Opoint]: \"发射\",\r\n  [TabEnum.Bpoint]: \"吐血\"\r\n}\r\nexport const img_map = (window as any).img_map = new Map<string, HTMLImageElement>();\r\nexport interface IFrameEditorProps extends Omit<IFrameProps, 'onChange' | 'defaultValue'>, IFieldProps<IFrameInfo> {\r\n  data?: IEntityData;\r\n  selected?: boolean;\r\n}\r\nexport function FrameEditor(props: IFrameEditorProps) {\r\n  const { value, defaultValue = default_value, onChange, data, onBlur, onFocus, style, ..._p } = props;\r\n  const [editing, set_editing] = useState<TabEnum | undefined>(TabEnum.Base);\r\n  // const Editor = useEditor<IFrameInfo>(value)\r\n  const ref_root = useRef<HTMLDivElement>(null)\r\n  const label = `frame: ${value?.id}`\r\n  const on_blur = useThrough(onBlur, () => {\r\n    console.log(`[${TAG}>>on_blur] called.`)\r\n  })\r\n  const on_focus = useThrough(onFocus, () => {\r\n    console.log(`[${TAG}>>on_focus] called.`)\r\n  })\r\n  return (\r\n    <Frame\r\n      label={label}\r\n      {..._p}\r\n      ref={ref_root}\r\n      tabIndex={-1}\r\n      onBlur={on_blur}\r\n      onFocus={on_focus}\r\n      style={{ ...style, overflow: 'hidden', display: 'flex', flexDirection: 'column', gap: 5 }}>\r\n      <Space direction='column' stretchs>\r\n        {/* <Editor.String field='id' />\r\n        <Editor.String field='name' /> */}\r\n        <Space.Item style={{ display: 'flex' }}>\r\n          <TabButtons\r\n            style={{ flex: 1 }}\r\n            value={editing}\r\n            items={Object.values(TabEnum)}\r\n            parse={v => [v, tab_labels[v]]}\r\n            onChange={v => set_editing(prev => v === prev ? void 0 : v)}\r\n            styles={{ button: { flex: 1 } }} />\r\n        </Space.Item>\r\n        <Show show={editing === 'base'}>\r\n          <Space direction=\"column\" stretchs>\r\n            {/* <Editor.Select {...STATE_SELECT_PROPS} field=\"state\" />\r\n            <Titled float_label='图片' style={{ width: '100%' }}>\r\n              <Combine direction='column' style={{ flex: 1 }}>\r\n                <Input defaultValue={value.pic?.tex} prefix=\"tex\" style={{ flex: 1 }} data-flex={1} />\r\n                <Combine style={{ flex: 1 }} data-flex={1}>\r\n                  <Input defaultValue={value.pic?.x} prefix=\"x\" style={{ flex: 1 }} data-flex={1} />\r\n                  <Input defaultValue={value.pic?.y} prefix=\"y\" style={{ flex: 1 }} data-flex={1} />\r\n                  <Input defaultValue={value.pic?.w} prefix=\"w\" style={{ flex: 1 }} data-flex={1} />\r\n                  <Input defaultValue={value.pic?.h} prefix=\"h\" style={{ flex: 1 }} data-flex={1} />\r\n                </Combine>\r\n              </Combine>\r\n            </Titled>\r\n            <Editor.EditorVec2 name=\"锚点\" fields={['centerx', 'centery']} />\r\n            <Editor.Number defaultValue={value.wait} field=\"wait\" clearable={false} title=\"当前动作持续多少帧数\" /> */}\r\n          </Space>\r\n        </Show>\r\n        <Show show={editing === TabEnum.Spd}>\r\n          <Space direction=\"column\" stretchs>\r\n            {/* <Editor.Number3 name=\"速度\" fields={['dvx', 'dvy', 'dvz']} />\r\n            <Editor.Number3 name=\"加速度\" fields={['acc_x', 'acc_y', 'acc_z']} />\r\n            <Editor.Sel3\r\n              name=\"速度模式\"\r\n              fields={['vxm', 'vym', 'vzm']}\r\n              placeholders={['x', 'y', 'z']}\r\n              select={SPEED_MODE_SELECT_PROPS} /> */}\r\n          </Space>\r\n        </Show>\r\n      </Space>\r\n      <Show show={editing === 'itr'}>\r\n        <>\r\n          <Button\r\n            style={{ alignSelf: 'stretch' }}\r\n            onClick={() => {\r\n              const next: IFrameInfo = { ...(value || defaultValue) }\r\n              next.itr = ensure(next.itr, ItrEditor.genValue())\r\n              onChange?.(next)\r\n            }}>\r\n            add itr\r\n          </Button>\r\n          <Flex direction='column' gap={5} style={{ flex: 1, overflowY: 'auto', height: 0 }} >\r\n            {\r\n              map_arr(value?.itr, (itr, idx) => {\r\n                const name = `itr[${idx}]`;\r\n                const on_change = (itr: IItrInfo) => {\r\n                  const next: IFrameInfo = { ...(value || defaultValue) }\r\n                  next.itr = [...next.itr!]\r\n                  next.itr[idx] = itr;\r\n                  onChange?.(next)\r\n                }\r\n                const on_remove = () => {\r\n                  const next: IFrameInfo = { ...(value || defaultValue) }\r\n                  next.itr = [...next.itr!]\r\n                  next.itr.splice(idx, 1)\r\n                  if (!next.itr.length) delete next.itr\r\n                  onChange?.(next)\r\n                }\r\n                return (\r\n                  <ItrEditor\r\n                    key={name}\r\n                    label={name}\r\n                    value={itr}\r\n                    variants={['no_border', 'no_round', 'no_shadow']}\r\n                    onChange={on_change}\r\n                    onRemove={on_remove}\r\n                  />\r\n                )\r\n              })\r\n            }\r\n          </Flex>\r\n        </>\r\n      </Show>\r\n      {/* <Show show={editing === 'bdy'}>\r\n        <Button style={{ alignSelf: 'stretch' }} onClick={() => {\r\n          set_frame(prev => {\r\n            const next: IFrameInfo = { ...prev };\r\n            const bdy: IBdyInfo = {\r\n              z: 0, l: 0, x: 0, y: 0, w: 0, h: 0,\r\n              kind: BdyKind.Normal,\r\n            }\r\n            if (next.bdy) next.bdy = [bdy, ...next.bdy]\r\n            else next.bdy = [bdy]\r\n            return next;\r\n          })\r\n        }}>\r\n          add bdy\r\n        </Button>\r\n        {\r\n          value.bdy && map_arr(value.bdy, (bdy, idx) => {\r\n            const name = `bdy[${idx}]`;\r\n            const on_change = (bdy: IBdyInfo) => set_frame(prev => {\r\n              const next: IFrameInfo = { ...prev }\r\n              if (next.bdy) {\r\n                next.bdy[idx] = bdy\r\n                next.bdy = [...next.bdy]\r\n              }\r\n              return next\r\n            })\r\n            const on_remove = () => set_frame(prev => {\r\n              const next: IFrameInfo = { ...prev };\r\n              next.bdy?.splice(idx, 1)\r\n              if (next.bdy?.length) next.bdy = [...next.bdy]\r\n              if (!next.bdy?.length) delete next.bdy;\r\n              return next;\r\n            })\r\n            return (\r\n              <BdyEditorView\r\n                key={name}\r\n                label={name}\r\n                value={bdy}\r\n                onChange={on_change}\r\n                onRemove={on_remove} />\r\n            )\r\n          })\r\n        }\r\n      </Show> */}\r\n    </Frame>\r\n  );\r\n}\r\nconst default_value: IFrameInfo = {\r\n  id: \"\",\r\n  name: \"\",\r\n  state: 0,\r\n  wait: 0,\r\n  next: {},\r\n  centerx: 0,\r\n  centery: 0\r\n}\r\nexport default function FrameEditorDemoView() {\r\n  const [value, set_value] = useState<IFrameInfo | undefined>(default_value)\r\n  return (\r\n    <Flex direction='column' gap={5} style={{ overflow: 'hidden', height: `100%` }}>\r\n      <TextArea style={{ resize: 'vertical', height: 300 }} readOnly value={JSON.stringify(value, null, 2)} />\r\n      <FrameEditor value={value} onChange={set_value} style={{ flex: 1 }} />\r\n    </Flex>\r\n  )\r\n}","export function map_arr<T, V>(list: T | T[] | null | undefined, fn: (item: T, idx: number, arr: T[]) => V): V[] {\n  if (!list) return []\n  if (Array.isArray(list)) return list.map(fn);\n  else return [fn(list, 0, [list])];\n}\n","/*!\n\tCopyright (c) 2018 Jed Watson.\n\tLicensed under the MIT License (MIT), see\n\thttp://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames () {\n\t\tvar classes = '';\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (arg) {\n\t\t\t\tclasses = appendClass(classes, parseValue(arg));\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction parseValue (arg) {\n\t\tif (typeof arg === 'string' || typeof arg === 'number') {\n\t\t\treturn arg;\n\t\t}\n\n\t\tif (typeof arg !== 'object') {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (Array.isArray(arg)) {\n\t\t\treturn classNames.apply(null, arg);\n\t\t}\n\n\t\tif (arg.toString !== Object.prototype.toString && !arg.toString.toString().includes('[native code]')) {\n\t\t\treturn arg.toString();\n\t\t}\n\n\t\tvar classes = '';\n\n\t\tfor (var key in arg) {\n\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\tclasses = appendClass(classes, key);\n\t\t\t}\n\t\t}\n\n\t\treturn classes;\n\t}\n\n\tfunction appendClass (value, newClass) {\n\t\tif (!newClass) {\n\t\t\treturn value;\n\t\t}\n\t\n\t\tif (value) {\n\t\t\treturn value + ' ' + newClass;\n\t\t}\n\t\n\t\treturn value + newClass;\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n"],"names":["titled_styles","label","width","textAlign","default_value","hit_flag","HitFlag","AllEnemy","kind","ItrKind","Normal","effect","ItrEffect","z","floor","Defines","DAFUALT_QUBE_LENGTH","l","x","y","w","h","ItrEditor","props","_value$kind","value","defaultValue","onRemove","onChange","_p","is_vrest","_jsxs","Frame","tabIndex","children","_jsx","Button","style","position","right","top","border","onClick","Flex","direction","align","gap","Titled","styles","Combine","Select","ITR_KIND_SELECT_PROPS","make_field_props","v","kind_name","itr_kind_full_name","effect_name","Show","show","ITR_EFFECT_SELECT_PROPS","itr_effect_full_name","HitFlagEditor","flex","Input","Number","make_not_blank_field_props","clearable","placeholder","DEFAULT_ITR_MOTIONLESS","step","DEFAULT_ITR_SHAKING","items","parse","next","rest","arest","vrest","DEFAULT_ITR_FALL","QubeEdit","TextArea","resize","ItrEditorTestView","set_value","useState","height","readOnly","JSON","stringify","genValue","fn","TabButtons","disabled","classNames","map","item","idx","className","button","e","actived","useThrough","func","mine","ref_func","useRef","current","_ref_func$current","_len","arguments","length","args","Array","_key","call","TAG","TabEnum","tab_labels","Base","Spd","Itr","Bdy","Cpoint","Opoint","Bpoint","img_map","window","Map","FrameEditor","data","onBlur","onFocus","editing","set_editing","ref_root","id","on_blur","console","log","on_focus","ref","overflow","display","flexDirection","Space","stretchs","Item","Object","values","prev","_Fragment","alignSelf","itr","ensure","overflowY","list","name","variants","on_remove","splice","isArray","state","wait","centerx","centery","FrameEditorDemoView","hasOwn","hasOwnProperty","classes","i","arg","appendClass","parseValue","apply","toString","prototype","includes","key","newClass","module","exports","default"],"sourceRoot":""}